import{r as d,j as e,U as ne,e as $,H as ie,F as oe,X as S,A as de,c as ce,h as me,t as xe}from"./index-Z4L9-lCG.js";import{g as he,d as ue,c as pe,u as be}from"./patientStories-Dl1EgJFx.js";import{g as ge,a as fe,b as je}from"./patientStoryHelpers-DRxpbJ-I.js";import{S as H}from"./star-Djb-bVj1.js";import{I as ve}from"./image-8jStGaz_.js";import{V as ye}from"./video-wHFqyHjI.js";import{U as Ne}from"./upload-Sue4gAut.js";import{P as E}from"./plus-BHSJqwky.js";import{P as we}from"./pill-ClJ4K0x8.js";import{C as _e}from"./check-circle-DJqXdf__.js";import{A as ke}from"./alert-circle-CdBNdKG8.js";import{S as J}from"./search-Bw7LNGH_.js";import{P as Ce}from"./play-FRFDAPDu.js";import{C as Se}from"./clock-CUBqhNFg.js";import{C as ze}from"./calendar-92JDbxfr.js";import{C as Te}from"./credit-card-BAh1xXHM.js";import{E as Ee}from"./eye--hYI9hvJ.js";import{T as Pe}from"./trash-2-PiHk2pnV.js";import{A as qe}from"./award-BaUFKc3o.js";import{S as Z}from"./save-3kTS1myQ.js";const ee=({formData:a,doctors:p,onInputChange:c,onFormDataChange:P,imagePreview:q,onImageUpload:M,onRemoveImage:U})=>{const[g,L]=d.useState(""),[f,F]=d.useState(""),[x,y]=d.useState(""),[o,A]=d.useState("uz"),O=(t,r)=>{const h=r.translations||{},v=h[t]||{patient_name:"",diagnosis:"",story_content:"",treatment_duration:"",outcome:"",doctor_name:r.doctor_name||"",symptoms:r.symptoms||[],treatment_methods:r.treatment_methods||[],medications:r.medications||[],lifestyle_changes:r.lifestyle_changes||"",meta_title:"",meta_description:""};return{current:h,langObj:v}},b=(t,r)=>{if(o==="uz"){c(t,r);return}const h=o;P(v=>{const{current:w,langObj:u}=O(h,v);return{...v,translations:{...w,[h]:{...u,[t]:r}}}})},m=t=>{if(o==="uz")return a[t]??"";const r=o;return a.translations?.[r]?.[t]??""},z=()=>{g.trim()&&!a.symptoms.includes(g.trim())&&(c("symptoms",[...a.symptoms,g.trim()]),L(""))},k=t=>{c("symptoms",a.symptoms.filter(r=>r!==t))},N=()=>{f.trim()&&!a.treatment_methods.includes(f.trim())&&(c("treatment_methods",[...a.treatment_methods,f.trim()]),F(""))},R=t=>{c("treatment_methods",a.treatment_methods.filter(r=>r!==t))},T=()=>{x.trim()&&!a.medications.includes(x.trim())&&(c("medications",[...a.medications,x.trim()]),y(""))},j=t=>{c("medications",a.medications.filter(r=>r!==t))};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary",children:"Til"}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-800 rounded-lg p-1 overflow-x-auto",children:[{code:"uz",label:"O'zbek",flag:"ðŸ‡ºðŸ‡¿"},{code:"ru",label:"Ð ÑƒÑÑÐºÐ¸Ð¹",flag:"ðŸ‡·ðŸ‡º"},{code:"en",label:"English",flag:"ðŸ‡ºðŸ‡¸"}].map(t=>e.jsxs("button",{type:"button",onClick:()=>A(t.code),className:`px-3 py-2 text-sm font-medium rounded-md transition-all duration-200 flex items-center space-x-2 whitespace-nowrap ${o===t.code?"bg-white dark:bg-gray-700 theme-text shadow-sm":"theme-text-secondary hover:theme-text"}`,children:[e.jsx("span",{children:t.flag}),e.jsx("span",{className:"hidden sm:inline",children:t.label})]},t.code))})]})}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold theme-text mb-4 flex items-center space-x-2",children:[e.jsx(ne,{size:20,className:"text-blue-600"}),e.jsx("span",{children:"Asosiy Ma'lumotlar"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:["Bemor ismi * ",o!=="uz"&&e.jsxs("span",{className:"theme-text-muted",children:["(",o.toUpperCase(),")"]})]}),e.jsx("input",{type:"text",value:m("patient_name"),onChange:t=>b("patient_name",t.target.value),required:!0,className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text",placeholder:"Bemor to'liq ismi"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Yoshi *"}),e.jsx("input",{type:"number",value:a.age,onChange:t=>c("age",parseInt(t.target.value)||0),required:!0,min:"1",max:"120",className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:["Tashxis * ",o!=="uz"&&e.jsxs("span",{className:"theme-text-muted",children:["(",o.toUpperCase(),")"]})]}),e.jsx("input",{type:"text",value:m("diagnosis"),onChange:t=>b("diagnosis",t.target.value),required:!0,className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text",placeholder:"Kasallik tashxisi"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Davolash shifokor *"}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 theme-text-muted",size:16}),e.jsxs("select",{value:a.doctor_name,onChange:t=>c("doctor_name",t.target.value),required:!0,className:"w-full pl-10 pr-4 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text appearance-none",children:[e.jsx("option",{value:"",children:"Shifokorni tanlang"}),p.map(t=>e.jsxs("option",{value:t.full_name,children:[t.full_name," - ",t.specialization]},t.id))]})]}),p.length===0&&e.jsx("p",{className:"text-xs theme-text-muted mt-1",children:"Hozircha shifokorlar mavjud emas. Avval shifokor qo'shing."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:["Davolash muddati * ",o!=="uz"&&e.jsxs("span",{className:"theme-text-muted",children:["(",o.toUpperCase(),")"]})]}),e.jsx("input",{type:"text",value:m("treatment_duration"),onChange:t=>b("treatment_duration",t.target.value),required:!0,className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text",placeholder:"Masalan: 6 oy, 1 yil"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Reyting *"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(t=>e.jsx("button",{type:"button",onClick:()=>c("rating",t),className:`p-1 transition-colors duration-200 ${t<=a.rating?"text-yellow-500":"text-gray-300"}`,children:e.jsx(H,{size:20,className:t<=a.rating?"fill-current":""})},t))}),e.jsxs("span",{className:"text-sm theme-text-secondary",children:["(",a.rating,"/5)"]})]})]})]})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold theme-text mb-4 flex items-center space-x-2",children:[e.jsx(ie,{size:20,className:"text-red-600"}),e.jsx("span",{children:"Bemor Hikoyasi"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:["Hikoya matni * ",o!=="uz"&&e.jsxs("span",{className:"theme-text-muted",children:["(",o.toUpperCase(),")"]})]}),e.jsx("textarea",{value:m("story_content"),onChange:t=>b("story_content",t.target.value),required:!0,rows:6,className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text resize-none",placeholder:"Bemorning to'liq hikoyasini yozing..."}),e.jsxs("div",{className:"text-xs theme-text-muted mt-1",children:[m("story_content").length," belgi"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:["Davolash natijasi * ",o!=="uz"&&e.jsxs("span",{className:"theme-text-muted",children:["(",o.toUpperCase(),")"]})]}),e.jsx("textarea",{value:m("outcome"),onChange:t=>b("outcome",t.target.value),required:!0,rows:3,className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text resize-none",placeholder:"Davolash natijasi va hozirgi holat"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Turmush tarzi o'zgarishlari"}),e.jsx("textarea",{value:a.lifestyle_changes,onChange:t=>c("lifestyle_changes",t.target.value),rows:3,className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text resize-none",placeholder:"Ovqatlanish, mashqlar, kundalik rejim o'zgarishlari"})]})]})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold theme-text mb-4",children:"Kontent Turi"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[{type:"text",icon:oe,label:"Matn Hikoyasi"},{type:"image",icon:ve,label:"Rasm Hikoyasi"},{type:"video",icon:ye,label:"Video Hikoya"}].map(({type:t,icon:r,label:h})=>e.jsxs("button",{type:"button",onClick:()=>c("content_type",t),className:`p-4 border-2 rounded-lg transition-all duration-200 ${a.content_type===t?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"theme-border hover:border-gray-300 dark:hover:border-gray-500 theme-text-secondary"}`,children:[e.jsx(r,{size:24,className:"mx-auto mb-2"}),e.jsx("div",{className:"text-sm font-medium",children:h})]},t))})]}),(a.content_type==="image"||a.content_type==="video")&&e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6 animate-fade-in",children:[a.content_type==="image"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-4",children:"Hikoya rasmi"}),q?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:q,alt:"Preview",className:"w-full h-48 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:U,className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors duration-200",children:e.jsx(S,{size:16})})]}):e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-48 border-2 theme-border border-dashed rounded-lg cursor-pointer theme-bg-tertiary hover:theme-bg-quaternary transition-colors duration-200",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx(Ne,{className:"w-8 h-8 mb-4 theme-text-muted"}),e.jsxs("p",{className:"mb-2 text-sm theme-text-secondary",children:[e.jsx("span",{className:"font-semibold",children:"Yuklash uchun bosing"})," yoki sudrab tashlang"]}),e.jsx("p",{className:"text-xs theme-text-muted",children:"PNG, JPG, WEBP (max 5MB)"})]}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:M})]})]}),a.content_type==="video"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"YouTube Video URL"}),e.jsx("input",{type:"url",placeholder:"https://www.youtube.com/watch?v=...",value:a.youtube_url||"",onChange:t=>c("youtube_url",t.target.value),className:"w-full px-4 py-3 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold theme-text mb-4 flex items-center space-x-2",children:[e.jsx(de,{size:20,className:"text-orange-600"}),e.jsx("span",{children:"Kasallik Belgilari"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",placeholder:"Yangi belgi qo'shish",value:g,onChange:t=>L(t.target.value),onKeyPress:t=>t.key==="Enter"&&(t.preventDefault(),z()),className:"flex-1 px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text text-sm"}),e.jsx("button",{type:"button",onClick:z,className:"px-3 py-2 theme-accent-bg text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:e.jsx(E,{size:16})})]}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:a.symptoms.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-orange-50 dark:bg-orange-900/20 text-orange-800 dark:text-orange-200 rounded-lg text-sm",children:[e.jsx("span",{children:t}),e.jsx("button",{type:"button",onClick:()=>k(t),className:"text-orange-600 dark:text-orange-400 hover:text-orange-800 dark:hover:text-orange-300",children:e.jsx(S,{size:14})})]},r))})]})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold theme-text mb-4 flex items-center space-x-2",children:[e.jsx($,{size:20,className:"text-blue-600"}),e.jsx("span",{children:"Davolash Usullari"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",placeholder:"Davolash usuli qo'shish",value:f,onChange:t=>F(t.target.value),onKeyPress:t=>t.key==="Enter"&&(t.preventDefault(),N()),className:"flex-1 px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text text-sm"}),e.jsx("button",{type:"button",onClick:N,className:"px-3 py-2 theme-accent-bg text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:e.jsx(E,{size:16})})]}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:a.treatment_methods.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-blue-50 dark:bg-blue-900/20 text-blue-800 dark:text-blue-200 rounded-lg text-sm",children:[e.jsx("span",{children:t}),e.jsx("button",{type:"button",onClick:()=>R(t),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",children:e.jsx(S,{size:14})})]},r))})]})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold theme-text mb-4 flex items-center space-x-2",children:[e.jsx(we,{size:20,className:"text-green-600"}),e.jsx("span",{children:"Dorilar"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",placeholder:"Dori qo'shish",value:x,onChange:t=>y(t.target.value),onKeyPress:t=>t.key==="Enter"&&(t.preventDefault(),T()),className:"flex-1 px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text text-sm"}),e.jsx("button",{type:"button",onClick:T,className:"px-3 py-2 theme-accent-bg text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:e.jsx(E,{size:16})})]}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:a.medications.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-200 rounded-lg text-sm",children:[e.jsx("span",{children:t}),e.jsx("button",{type:"button",onClick:()=>j(t),className:"text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300",children:e.jsx(S,{size:14})})]},r))})]})]})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold theme-text mb-4",children:"SEO Sozlamalari"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:["Meta sarlavha ",o!=="uz"&&e.jsxs("span",{className:"theme-text-muted",children:["(",o.toUpperCase(),")"]})]}),e.jsx("input",{type:"text",value:m("meta_title"),onChange:t=>b("meta_title",t.target.value),className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text",placeholder:"SEO uchun sarlavha"}),e.jsxs("div",{className:"text-xs theme-text-muted mt-1",children:[m("meta_title").length,"/60 belgi"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:["Meta tavsif ",o!=="uz"&&e.jsxs("span",{className:"theme-text-muted",children:["(",o.toUpperCase(),")"]})]}),e.jsx("textarea",{value:m("meta_description"),onChange:t=>b("meta_description",t.target.value),rows:2,className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text resize-none",placeholder:"SEO uchun qisqacha tavsif"}),e.jsxs("div",{className:"text-xs theme-text-muted mt-1",children:[m("meta_description").length,"/160 belgi"]})]})]})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold theme-text mb-4",children:"Nashr Sozlamalari"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"published",checked:a.published,onChange:t=>c("published",t.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"published",className:"text-sm font-medium theme-text-secondary",children:"Darhol nashr etish"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"featured",checked:a.featured,onChange:t=>c("featured",t.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"featured",className:"text-sm font-medium theme-text-secondary",children:"Asosiy hikoya"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Tartib raqami"}),e.jsx("div",{className:"w-full px-3 py-2 theme-border border rounded-lg theme-bg theme-text text-sm",children:"Avtomatik belgilanadi"})]})]})]})]})},Ze=()=>{const{t:a}=ce(),[p,c]=d.useState([]),[P,q]=d.useState([]),[M,U]=d.useState(!0),[g,L]=d.useState(""),[f,F]=d.useState("all"),[x,y]=d.useState("all"),[o,A]=d.useState(!1),[O,b]=d.useState(!1),[m,z]=d.useState(null),[k,N]=d.useState(!1),[R,T]=d.useState(null),[j,t]=d.useState({type:"",text:""}),[r,h]=d.useState(null),[v,w]=d.useState(!1),[u,_]=d.useState({patient_name:"",age:25,diagnosis:"",story_content:"",treatment_duration:"",outcome:"",doctor_name:"",content_type:"text",symptoms:[],treatment_methods:[],medications:[],lifestyle_changes:"",rating:5,featured:!1,published:!1,order_index:0,meta_title:"",meta_description:""});d.useEffect(()=>{D()},[]);const D=async()=>{U(!0);try{const[s,n]=await Promise.all([he(),me("uz",{active:!0,verified:!0})]);s.data&&c(s.data),n.data&&q(n.data)}catch{t({type:"error",text:a("psmErrorLoading")})}finally{U(!1)}},V=(s,n)=>{_(l=>({...l,[s]:n})),j.text&&t({type:"",text:""})},B=s=>{const n=s.target.files?.[0];if(n){if(n.size>5*1024*1024){t({type:"error",text:a("psmImageSizeError")});return}_(i=>({...i,featured_image:n}));const l=new FileReader;l.onload=()=>h(l.result),l.readAsDataURL(n)}},K=()=>{_(s=>({...s,featured_image:void 0})),h(null)},Y=()=>{_({patient_name:"",age:25,diagnosis:"",story_content:"",treatment_duration:"",outcome:"",doctor_name:"",content_type:"text",symptoms:[],treatment_methods:[],medications:[],lifestyle_changes:"",rating:5,featured:!1,published:!1,order_index:0,meta_title:"",meta_description:""}),z(null),h(null)},I=()=>{Y(),A(!0)},te=s=>{const n=(s.translations||[]).reduce((l,i)=>((i.language==="ru"||i.language==="en")&&(l[i.language]={patient_name:i.patient_name||"",diagnosis:i.diagnosis||"",story_content:i.story_content||"",treatment_duration:i.treatment_duration||"",outcome:i.outcome||"",doctor_name:i.doctor_name||"",symptoms:i.symptoms||s.symptoms||[],treatment_methods:i.treatment_methods||s.treatment_methods||[],medications:i.medications||s.medications||[],lifestyle_changes:i.lifestyle_changes||s.lifestyle_changes||"",meta_title:i.meta_title||"",meta_description:i.meta_description||""}),l),{});_({patient_name:s.patient_name,age:s.age,diagnosis:s.diagnosis,story_content:s.story_content,treatment_duration:s.treatment_duration,outcome:s.outcome,doctor_name:s.doctor_name,content_type:s.content_type,youtube_url:s.youtube_url,symptoms:s.symptoms||[],treatment_methods:s.treatment_methods||[],medications:s.medications||[],lifestyle_changes:s.lifestyle_changes||"",rating:s.rating||5,featured:s.featured||!1,published:s.published||!1,order_index:s.order_index||0,meta_title:s.meta_title||"",meta_description:s.meta_description||"",translations:n}),s.featured_image_url&&h(s.featured_image_url),z(s),b(!0)},C=()=>{A(!1),b(!1),Y(),t({type:"",text:""})},G=()=>u.patient_name.trim()?u.diagnosis.trim()?u.story_content.trim()?u.doctor_name.trim()?u.content_type==="video"&&!u.youtube_url?(t({type:"error",text:a("psmYoutubeRequired")}),!1):!0:(t({type:"error",text:a("psmDoctorRequired")}),!1):(t({type:"error",text:a("psmContentRequired")}),!1):(t({type:"error",text:a("psmDiagnosisRequired")}),!1):(t({type:"error",text:a("psmNameRequired")}),!1),se=async s=>{if(s.preventDefault(),!!G()){N(!0),t({type:"",text:""});try{const n=p.length>0?Math.max(...p.map(X=>typeof X.order_index=="number"?X.order_index:0))+1:1,l={...u,order_index:n},{data:i,error:W}=await pe(l);W?t({type:"error",text:a("psmError")+": "+W.message}):(t({type:"success",text:a("psmCreated")}),await D(),setTimeout(()=>{C()},1500))}catch{t({type:"error",text:a("psmGeneralError")})}finally{N(!1)}}},ae=async s=>{if(s.preventDefault(),!(!m||!G())){N(!0),t({type:"",text:""});try{const{data:n,error:l}=await be({id:m.id,...u});l?t({type:"error",text:a("psmError")+": "+l.message}):(t({type:"success",text:a("psmUpdated")}),await D(),setTimeout(()=>{C()},1500))}catch{t({type:"error",text:a("psmGeneralError")})}finally{N(!1)}}},re=async(s,n)=>{if(confirm(`${n}${a("psmConfirmDelete")}`)){T(s),t({type:"",text:""});try{const{error:l}=await ue(s);l?t({type:"error",text:l.message}):(t({type:"success",text:a("psmDeleted")}),await D())}catch{t({type:"error",text:a("psmErrorOccurred")})}finally{T(null)}}},Q=p.filter(s=>{const n=s.patient_name.toLowerCase().includes(g.toLowerCase())||s.diagnosis.toLowerCase().includes(g.toLowerCase())||s.doctor_name.toLowerCase().includes(g.toLowerCase()),l=f==="all"||s.content_type===f,i=x==="all"||x==="published"&&s.published||x==="draft"&&!s.published||x==="featured"&&s.featured;return n&&l&&i}),le=s=>new Date(s).toLocaleDateString("uz-UZ",{year:"numeric",month:"short",day:"numeric"});return M?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"theme-text-muted",children:a("psmLoading")})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold theme-text",children:a("psmTitle")}),e.jsx("p",{className:"theme-text-secondary",children:a("psmDesc")})]}),e.jsxs("button",{onClick:I,className:"flex items-center space-x-2 theme-accent-bg text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200",children:[e.jsx(E,{size:20}),e.jsx("span",{children:a("psmNewStory")})]})]}),j.text&&e.jsxs("div",{className:`p-4 rounded-xl flex items-center space-x-2 animate-slide-down ${j.type==="success"?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800"}`,children:[j.type==="success"?e.jsx(_e,{size:20,className:"text-green-600 dark:text-green-400"}):e.jsx(ke,{size:20,className:"text-red-600 dark:text-red-400"}),e.jsx("span",{className:j.type==="success"?"text-green-700 dark:text-green-300":"text-red-700 dark:text-red-300",children:j.text})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-4",children:[e.jsx("div",{className:"text-2xl font-bold theme-text",children:p.length}),e.jsx("div",{className:"text-sm theme-text-secondary",children:a("psmTotalStories")})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:p.filter(s=>s.published).length}),e.jsx("div",{className:"text-sm theme-text-secondary",children:a("psmPublished")})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:p.filter(s=>s.featured).length}),e.jsx("div",{className:"text-sm theme-text-secondary",children:a("psmFeatured")})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:p.filter(s=>s.content_type==="video").length}),e.jsx("div",{className:"text-sm theme-text-secondary",children:a("psmVideo")})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:p.filter(s=>s.content_type==="image").length}),e.jsx("div",{className:"text-sm theme-text-secondary",children:a("psmImage")})]})]}),e.jsx("div",{className:"theme-bg rounded-lg theme-shadow theme-border border p-4 lg:p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-3 lg:gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(J,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 theme-text-muted",size:18}),e.jsx("input",{type:"text",placeholder:a("psmSearch"),value:g,onChange:s=>L(s.target.value),className:"w-full pl-10 pr-4 py-2 lg:py-3 bg-gray-50 border border-gray-200 rounded-lg focus:border-blue-500 transition-all duration-200 theme-text text-sm"})]})}),e.jsx("div",{className:"lg:w-48",children:e.jsxs("select",{value:f,onChange:s=>F(s.target.value),className:"w-full px-3 lg:px-4 py-2 lg:py-3 bg-gray-50 border border-gray-200 rounded-lg focus:border-blue-500 transition-all duration-200 theme-text text-sm",children:[e.jsx("option",{value:"all",children:a("psmAllTypes")}),e.jsx("option",{value:"text",children:a("psmText")}),e.jsx("option",{value:"image",children:a("psmImage")}),e.jsx("option",{value:"video",children:a("psmVideo")})]})}),e.jsxs("div",{className:"lg:w-48 relative",children:[e.jsxs("button",{onClick:s=>{s.stopPropagation(),w(!v)},className:"w-full px-3 lg:px-4 py-2 lg:py-3 bg-gray-50 border border-gray-200 rounded-lg focus:border-blue-500 transition-all duration-200 theme-text text-sm text-left flex items-center justify-between",children:[e.jsx("span",{children:a(x==="all"?"psmAllStatuses":x==="published"?"psmPublished":x==="draft"?"psmDraft":"psmFeatured")}),e.jsx(xe,{className:`theme-text-muted transition-transform ${v?"rotate-180":""}`,size:16})]}),v&&e.jsxs("div",{onClick:s=>s.stopPropagation(),className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10",children:[e.jsx("div",{onClick:()=>{y("all"),w(!1)},className:"px-4 py-2 hover:bg-gray-50 cursor-pointer theme-text",children:a("psmAllStatuses")}),e.jsx("div",{onClick:()=>{y("published"),w(!1)},className:"px-4 py-2 hover:bg-gray-50 cursor-pointer theme-text",children:a("psmPublished")}),e.jsx("div",{onClick:()=>{y("draft"),w(!1)},className:"px-4 py-2 hover:bg-gray-50 cursor-pointer theme-text",children:a("psmDraft")}),e.jsx("div",{onClick:()=>{y("featured"),w(!1)},className:"px-4 py-2 hover:bg-gray-50 cursor-pointer theme-text",children:a("psmFeatured")})]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Q.map(s=>{const n=ge(s.content_type);return e.jsxs("div",{className:"theme-bg rounded-2xl theme-shadow-lg hover:theme-shadow-xl transition-all duration-300 transform hover:-translate-y-2 theme-border border overflow-hidden group",children:[e.jsxs("div",{className:"relative h-48 overflow-hidden",children:[s.featured_image_url?e.jsx("img",{src:s.featured_image_url,alt:s.patient_name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"}):s.youtube_url?e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:`https://img.youtube.com/vi/${s.youtube_url.split("v=")[1]?.split("&")[0]||"dQw4w9WgXcQ"}/maxresdefault.jpg`,alt:s.patient_name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500",onError:l=>{const i=l.target;i.src=`https://img.youtube.com/vi/${s.youtube_url?.split("v=")[1]?.split("&")[0]||"dQw4w9WgXcQ"}/hqdefault.jpg`}}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center group-hover:bg-opacity-50 transition-all duration-300",children:e.jsx("div",{className:"w-16 h-16 bg-red-600 rounded-full flex items-center justify-center shadow-xl animate-pulse group-hover:scale-110 transition-transform duration-300",children:e.jsx(Ce,{size:24,className:"text-white ml-1"})})})]}):e.jsx("div",{className:"w-full h-full theme-bg-tertiary flex items-center justify-center group-hover:theme-bg-quaternary transition-colors duration-300",children:e.jsxs("div",{className:"text-center",children:[e.jsx(n,{size:48,className:"theme-text-muted mx-auto mb-3 group-hover:scale-110 transition-transform duration-300"}),e.jsx("p",{className:"theme-text-muted text-sm font-medium",children:a("psmTextStory")})]})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsxs("div",{className:"absolute top-4 left-4 flex flex-wrap gap-2",children:[e.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full ${je(s.content_type)}`,children:fe(s.content_type)}),e.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full ${s.published?"bg-green-500 text-white":"bg-yellow-500 text-white"}`,children:s.published?a("psmPublished"):a("psmDraft")}),s.featured&&e.jsxs("span",{className:"px-3 py-1 text-xs font-semibold bg-yellow-500 text-white rounded-full flex items-center space-x-1",children:[e.jsx(H,{size:12}),e.jsx("span",{children:a("psmFeatured")})]})]}),e.jsx("div",{className:"absolute bottom-4 right-4",children:e.jsx("div",{className:"flex items-center space-x-1 bg-white/95 backdrop-blur-sm rounded-full px-3 py-1 shadow-lg",children:[1,2,3,4,5].map(l=>e.jsx(H,{size:12,className:`${l<=(s.rating||5)?"text-yellow-500 fill-current":"text-gray-300"}`},l))})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-xl font-bold theme-text group-hover:theme-accent transition-colors duration-300",children:s.patient_name}),e.jsxs("span",{className:"text-sm theme-text-muted",children:[s.age," ",a("psmYearsOld")]})]}),e.jsx("p",{className:"text-red-600 dark:text-red-400 font-semibold text-sm mb-3",children:s.diagnosis}),e.jsx("p",{className:"theme-text-secondary text-sm mb-4 line-clamp-3 leading-relaxed",children:s.story_content}),e.jsxs("div",{className:"flex items-center justify-between text-sm theme-text-muted mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Se,{size:14}),e.jsx("span",{className:"truncate max-w-20",children:s.treatment_duration})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx($,{size:14}),e.jsx("span",{className:"truncate max-w-24",children:s.doctor_name})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ze,{size:14}),e.jsx("span",{children:le(s.created_at)})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs theme-text-muted mb-4 p-3 theme-bg-secondary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{children:[s.symptoms?.length||0," ",a("psmSymptoms")]}),e.jsxs("span",{children:[s.medications?.length||0," ",a("psmMedications")]}),e.jsxs("span",{children:[s.treatment_methods?.length||0," ",a("psmMethods")]})]}),e.jsx("span",{className:"text-green-600 dark:text-green-400 font-medium",children:a("psmSuccessful")})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t theme-border",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>te(s),className:"flex items-center space-x-1 theme-accent hover:text-blue-800 dark:hover:text-blue-300 p-2 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900 transition-all duration-200 transform hover:scale-105",title:a("psmEdit"),children:[e.jsx(Te,{size:16}),e.jsx("span",{className:"text-xs font-medium hidden sm:inline",children:a("psmEdit")})]}),e.jsxs("a",{href:`/patient-stories/${s.id}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 p-2 rounded-lg hover:bg-green-50 dark:hover:bg-green-900 transition-all duration-200 transform hover:scale-105",title:a("psmView"),children:[e.jsx(Ee,{size:16}),e.jsx("span",{className:"text-xs font-medium hidden sm:inline",children:a("psmView")})]}),e.jsx("button",{onClick:()=>re(s.id,s.patient_name),disabled:R===s.id,className:"flex items-center space-x-1 text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900 transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:transform-none",title:a("psmDelete"),children:R===s.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{size:16}),e.jsx("span",{className:"text-xs font-medium hidden sm:inline",children:a("psmDelete")})]})})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs theme-text-muted",children:[e.jsx(qe,{size:12}),e.jsxs("span",{children:[s.rating,"/5"]})]})]})]})]},s.id)})}),Q.length===0&&!M&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"theme-text-muted mb-4",children:e.jsx(J,{size:48,className:"mx-auto"})}),e.jsx("h3",{className:"text-xl font-semibold theme-text-secondary mb-2",children:a("psmNotFound")}),e.jsx("p",{className:"theme-text-muted mb-6",children:a("psmChangeSearchOrCreate")}),e.jsxs("button",{onClick:I,className:"inline-flex items-center space-x-2 theme-accent-bg text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors duration-200",children:[e.jsx(E,{size:20}),e.jsx("span",{children:a("psmCreateFirst")})]})]}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"theme-bg rounded-2xl theme-shadow-lg theme-border border p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold theme-text",children:a("psmNewModal")}),e.jsx("button",{onClick:C,className:"theme-text-secondary hover:theme-text p-1 rounded-lg hover:theme-bg-tertiary transition-colors duration-200",children:e.jsx(S,{size:20})})]}),e.jsxs("form",{onSubmit:se,children:[e.jsx(ee,{formData:u,doctors:P,onInputChange:V,onFormDataChange:_,imagePreview:r,onImageUpload:B,onRemoveImage:K}),e.jsxs("div",{className:"flex space-x-3 pt-6 mt-6 border-t theme-border",children:[e.jsx("button",{type:"button",onClick:C,className:"flex-1 theme-border border theme-text-secondary px-4 py-3 rounded-lg hover:theme-bg-tertiary transition-colors duration-200",children:a("psmCancel")}),e.jsxs("button",{type:"submit",disabled:k,className:"flex-1 bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 transition-colors duration-200 disabled:opacity-50 flex items-center justify-center space-x-2",children:[e.jsx(Z,{size:18}),e.jsx("span",{children:a(k?"psmCreating":"psmCreate")})]})]})]})]})}),O&&m&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"theme-bg rounded-2xl theme-shadow-lg theme-border border p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold theme-text",children:a("psmEditModal")}),e.jsx("button",{onClick:C,className:"theme-text-secondary hover:theme-text p-1 rounded-lg hover:theme-bg-tertiary transition-colors duration-200",children:e.jsx(S,{size:20})})]}),e.jsxs("form",{onSubmit:ae,children:[e.jsx(ee,{formData:u,doctors:P,onInputChange:V,onFormDataChange:_,imagePreview:r,onImageUpload:B,onRemoveImage:K}),e.jsxs("div",{className:"flex space-x-3 pt-6 mt-6 border-t theme-border",children:[e.jsx("button",{type:"button",onClick:C,className:"flex-1 theme-border border theme-text-secondary px-4 py-3 rounded-lg hover:theme-bg-tertiary transition-colors duration-200",children:a("psmCancel")}),e.jsxs("button",{type:"submit",disabled:k,className:"flex-1 bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 transition-colors duration-200 disabled:opacity-50 flex items-center justify-center space-x-2",children:[e.jsx(Z,{size:18}),e.jsx("span",{children:a(k?"psmSaving":"psmSave")})]})]})]})]})})]})};export{Ze as default};
