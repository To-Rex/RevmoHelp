import{c as F,r as l,i as R,k as I,j as e,L as Q,F as U,U as O}from"./index-DtX8_sFx.js";import{S as J}from"./SEOHead-BFTKnFen.js";import{g as K,T as V}from"./comments-DJuKBhZR.js";import{S as N}from"./search-gyIQzUfr.js";import{F as W}from"./filter-biRJLa_V.js";import{P as X}from"./play-qE8ylNa3.js";import{C as H}from"./clock-DjrY6wvX.js";import{E as w}from"./eye-OnB_qZXO.js";import{A as h}from"./arrow-right-B_FWij5W.js";import{C as Z}from"./calendar-eaebxh4X.js";import{M as G}from"./message-square-Dw2OfevJ.js";const ue=()=>{const{t:n,i18n:t}=F(),k=a=>a.youtube_url?t.language==="ru"?"–í–∏–¥–µ–æ":(t.language==="en","Video"):a.featured_image_url?t.language==="ru"?"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ":t.language==="en"?"Image":"Rasm":t.language==="ru"?"–¢–µ–∫—Å—Ç":t.language==="en"?"Text":"Matn",C=t.language==="ru"?"–¢–µ–∫—Å—Ç–æ–≤–∞—è —Å—Ç–∞—Ç—å—è":t.language==="en"?"Text Article":"Matn Maqolasi",S=t.language==="ru"?"–º–∏–Ω":t.language==="en"?"min":"daqiq–∞",z=t.language==="ru"?"–ß–∏—Ç–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ":t.language==="en"?"Read more":"Batafsil o'qish",_=a=>t.language==="ru"?`${a} –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤`:t.language==="en"?`${a} comments`:`${a} sharh`,D=a=>t.language==="ru"?`${a} –Ω—Ä–∞–≤–∏—Ç—Å—è`:t.language==="en"?`${a} likes`:`${a} yoqdi`,L=t.language==="ru"?"–ß–∏—Ç–∞—Ç—å":t.language==="en"?"Read":"O'qish",[i,f]=l.useState([]),[B,p]=l.useState([]),[Y,b]=l.useState({}),[q,m]=l.useState(!0),[ee,x]=l.useState(!1),[j,v]=l.useState(!1),[u,E]=l.useState(""),[g,M]=l.useState("all");l.useEffect(()=>{x(!1),v(!1),b({}),$()},[t.language]),l.useEffect(()=>{i.length>0&&!j&&A()},[i,j]);const $=async()=>{m(!0);try{console.log("üìù Loading posts and categories for language:",t.language);const a=`posts_page_${t.language}`,r=localStorage.getItem(a),s=localStorage.getItem(`${a}_timestamp`);if(r&&s&&Date.now()-parseInt(s)<180*1e3){const y=JSON.parse(r);f(y.posts),p(y.categories),x(!0),m(!1),console.log("üì¶ Using cached posts page data");return}const[o,d]=await Promise.all([R(t.language,{published:!0,allowMock:!1}),I()]);o.data&&(f(o.data),console.log("‚úÖ Posts loaded:",o.data.length)),d.data&&(p(d.data),console.log("‚úÖ Categories loaded:",d.data.length));const T={posts:o.data||[],categories:d.data||[]};localStorage.setItem(a,JSON.stringify(T)),localStorage.setItem(`${a}_timestamp`,Date.now().toString()),x(!0)}catch(a){console.error("Error loading data:",a)}finally{m(!1)}},A=async()=>{try{const a={};await Promise.all(i.map(async r=>{try{const s=await K(r.id);a[r.id]=s.data?.length||0}catch(s){console.error(`Error loading comments for post ${r.id}:`,s),a[r.id]=0}})),b(a),v(!0)}catch(a){console.error("Error loading comments count:",a)}},c=i.filter(a=>{const r=a.title.toLowerCase().includes(u.toLowerCase())||a.excerpt.toLowerCase().includes(u.toLowerCase()),s=g==="all"||a.category_id===g;return r&&s}),P=a=>new Date(a).toLocaleDateString("uz-UZ",{year:"numeric",month:"long",day:"numeric"});return q?e.jsx("div",{className:"min-h-screen theme-bg flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"theme-text-muted",children:"Maqolalar yuklanmoqda..."})]})}):e.jsxs("div",{className:"theme-bg min-h-screen",children:[e.jsx(J,{title:"Maqolalar",description:"Revmatik kasalliklar bo'yicha eng so'nggi maqolalar, maslahatlar va tibbiy ma'lumotlar. Professional shifokorlar tomonidan yozilgan.",keywords:"tibbiy maqolalar, revmatik kasalliklar, artrit, artroz, shifokor maslahatlari",url:"https://revmohelp.uz/posts"}),e.jsx("div",{className:"min-h-screen theme-bg pt-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-12 animate-fade-in",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold theme-text mb-4",children:n("posts")}),e.jsx("p",{className:"text-xl theme-text-secondary max-w-2xl mx-auto",children:n("postsSubtitle")})]}),e.jsx("div",{className:"bg-white rounded-2xl theme-shadow-lg theme-border border p-6 mb-8 animate-slide-up",style:{boxShadow:"0 -2px 4px -1px rgba(0, 0, 0, 0.03), 0 -6px 8px -2px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.05), 0 10px 15px -3px rgba(0, 0, 0, 0.1)"},children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(N,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 theme-text-muted",size:20}),e.jsx("input",{style:{backgroundColor:"#ffffff"},type:"text",placeholder:n("searchPosts"),value:u,onChange:a=>E(a.target.value),className:"w-full pl-10 pr-4 py-3 ring-1 ring-[#5FA8D3] border-transparent rounded-lg focus:ring-2 focus:ring-[#62B6CB] focus:border-[#62B6CB] transition-colors duration-200 bg-white dark:bg-[#3E433B] theme-text"})]})}),e.jsx("div",{className:"md:w-64",children:e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 theme-text-muted",size:20}),e.jsxs("select",{style:{backgroundColor:"#ffffff"},value:g,onChange:a=>M(a.target.value),className:"w-full pl-10 pr-4 py-3 ring-1 ring-[#5FA8D3] border-transparent rounded-lg focus:ring-2 focus:ring-[#62B6CB] focus:border-[#62B6CB] transition-colors duration-200 appearance-none bg-white dark:bg-[#3E433B] theme-text",children:[e.jsx("option",{value:"all",children:n("allCategories")}),B.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]})})]})}),e.jsx("div",{className:"mb-8",children:e.jsxs("p",{className:"theme-text-secondary",children:[e.jsx("span",{className:"font-semibold theme-text",children:c.length})," ",n("postsFound")]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12 items-stretch",children:c.map((a,r)=>e.jsx(Q,{to:`/posts/${a.slug}`,className:"group block h-full",style:{animationDelay:`${r*100}ms`},children:e.jsxs("article",{className:"bg-white rounded-3xl theme-shadow-lg theme-border border overflow-hidden animate-fade-in group-hover:scale-[1.02] h-full flex flex-col hover:theme-shadow-lg transition-all duration-500 hover:-translate-y-2 hover-medical",style:{boxShadow:"0 -2px 4px -1px rgba(0, 0, 0, 0.03), 0 -6px 8px -2px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.05), 0 10px 15px -3px rgba(0, 0, 0, 0.1)"},children:[e.jsxs("div",{className:"relative overflow-hidden aspect-[16/9]",children:[a.featured_image_url?e.jsx("img",{src:a.featured_image_url,alt:a.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700",loading:"lazy"}):a.youtube_url?e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:`https://img.youtube.com/vi/${a.youtube_url.split("v=")[1]?.split("&")[0]||"dQw4w9WgXcQ"}/maxresdefault.jpg`,alt:a.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700",loading:"lazy",onError:s=>{const o=s.target;o.src=`https://img.youtube.com/vi/${a.youtube_url?.split("v=")[1]?.split("&")[0]||"dQw4w9WgXcQ"}/hqdefault.jpg`}}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center group-hover:bg-opacity-50 transition-all duration-300",children:e.jsx("div",{className:"w-20 h-20 bg-red-600 rounded-full flex items-center justify-center shadow-xl animate-pulse group-hover:scale-110 transition-transform duration-300",children:e.jsx(X,{size:28,className:"text-white ml-1"})})})]}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-[#CAD8D6] to-[#B8C9C5] dark:from-[#4D544A] dark:to-[#3E433B] flex items-center justify-center group-hover:from-[#B8C9C5] group-hover:to-[#A6BAB4] dark:group-hover:from-[#5C6359] dark:group-hover:to-[#4D544A] transition-all duration-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(U,{size:56,className:"theme-text-muted mx-auto mb-3 group-hover:scale-110 transition-transform duration-300 opacity-60"}),e.jsx("p",{className:"theme-text-muted text-lg font-medium",children:C})]})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),a.category&&e.jsx("div",{className:"absolute top-4 left-4",children:e.jsx("span",{className:"px-3 py-1 text-xs font-bold text-white rounded-full shadow-lg backdrop-blur-sm",style:{backgroundColor:a.category.color},children:a.category.name})}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx("span",{className:`px-3 py-1 text-xs font-bold rounded-full shadow-lg ${a.youtube_url?"bg-red-500 text-white":a.featured_image_url?"bg-green-500 text-white":"bg-blue-500 text-white"}`,children:k(a)})}),e.jsx("div",{className:"absolute bottom-4 left-4",children:e.jsxs("div",{className:"flex items-center space-x-1 bg-white/95 backdrop-blur-sm rounded-full px-3 py-1 shadow-lg",children:[e.jsx(H,{size:12,className:"text-gray-600"}),e.jsxs("span",{className:"text-xs font-medium text-gray-900",children:[Math.ceil(a.content.length/1e3)," ",S]})]})}),e.jsx("div",{className:"absolute bottom-4 right-4",children:e.jsxs("div",{className:"flex items-center space-x-1 bg-white/95 backdrop-blur-sm rounded-full px-3 py-1 shadow-lg",children:[e.jsx(w,{size:12,className:"text-gray-600"}),e.jsx("span",{className:"text-xs font-bold text-gray-900",children:(a.views_count||0).toLocaleString()})]})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-full px-6 py-3 shadow-xl transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300",children:e.jsxs("span",{className:"text-gray-900 font-semibold flex items-center space-x-2",children:[e.jsx(h,{size:16}),e.jsx("span",{children:z})]})})})]}),e.jsxs("div",{className:"p-6 space-y-4 flex flex-col flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-100 to-teal-100 dark:from-blue-900/50 dark:to-teal-900/50 rounded-full flex items-center justify-center",children:e.jsx(O,{size:16,className:"theme-accent"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-semibold theme-text text-sm",children:a.author?.full_name}),a.author?.role==="doctor"&&e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-xs rounded-full font-bold",children:"Dr"})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs theme-text-muted",children:[e.jsx(Z,{size:10}),e.jsx("span",{children:P(a.published_at||a.created_at)})]})]})]}),e.jsx("h3",{className:"text-xl font-bold theme-text mb-3 line-clamp-2 group-hover:theme-accent transition-colors duration-300 leading-tight",children:a.title}),e.jsx("p",{className:"theme-text-secondary text-sm mb-4 line-clamp-3 leading-relaxed",children:a.excerpt}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[a.tags.slice(0,3).map(s=>e.jsxs("span",{className:"px-3 py-1 bg-[#CAD8D6] text-[#3E433B] dark:bg-[#5C6359] dark:text-white text-xs rounded-full font-medium border-0 hover:opacity-90 transition-colors duration-200",children:["#",s]},s)),a.tags.length>3&&e.jsxs("span",{className:"px-3 py-1 bg-[#CAD8D6] text-[#3E433B] dark:bg-[#5C6359] dark:text-white text-xs rounded-full font-medium border-0",children:["+",a.tags.length-3]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t theme-border mt-auto",children:[e.jsxs("div",{className:"flex items-center space-x-4 text-sm theme-text-muted",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(w,{size:14}),e.jsx("span",{className:"font-medium",children:(a.views_count||0).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(G,{size:14}),e.jsx("span",{className:"font-medium",children:_(Math.floor(Math.random()*20))})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(V,{size:14}),e.jsx("span",{className:"font-medium",children:D(Math.floor(Math.random()*50))})]})]}),e.jsxs("div",{className:"flex items-center space-x-1 theme-accent font-medium transition-colors duration-200",children:[e.jsx("span",{className:"text-sm",children:L}),e.jsx(h,{size:14,className:"group-hover:translate-x-1 transition-transform duration-200"})]})]})]})]})},a.id))}),c.length===0&&e.jsxs("div",{className:"text-center py-40",children:[e.jsx("div",{className:"theme-text-muted mb-4",children:e.jsx(N,{size:48,className:"mx-auto"})}),e.jsx("h3",{className:"text-xl font-semibold theme-text-secondary mb-2",children:"Maqola topilmadi"}),e.jsx("p",{className:"theme-text-muted",children:"Qidiruv so'zini o'zgartiring yoki filtrlarni qayta sozlang"})]}),c.length>0&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{className:"inline-flex items-center space-x-2 bg-[#62B6CB] text-white px-8 py-4 rounded-lg font-semibold hover:bg-[#5FA8D3] transition-colors duration-300 transform hover:scale-105",children:[e.jsx("span",{children:"Ko'proq maqolalarni ko'rish"}),e.jsx(h,{size:20})]})})]})})]})};export{ue as default};
