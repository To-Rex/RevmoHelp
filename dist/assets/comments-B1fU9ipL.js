import{m as d,W as c,Y as l,l as u,s as o,Z as p,g as m}from"./index-BLGelJha.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h=d("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]),g=async e=>{try{if(console.log("ðŸ’¬ Loading comments for post:",e),!u()||!o)return console.log("âš ï¸ Supabase not available, using mock data"),{data:s(e),error:null};const{data:a,error:r}=await o.from("comments").select(`
        *,
        author:profiles(id, full_name, role, avatar_url)
      `).eq("post_id",e).eq("approved",!0).is("parent_id",null).order("created_at",{ascending:!1});if(r)return console.log("âŒ Supabase error loading comments:",r),console.log("ðŸ”„ Falling back to mock data"),{data:s(e),error:null};const t=await Promise.all((a||[]).map(async n=>{const{data:i}=await o.from("comments").select(`
            *,
            author:profiles(id, full_name, role, avatar_url)
          `).eq("parent_id",n.id).eq("approved",!0).order("created_at",{ascending:!0});return{...n,replies:i||[],replies_count:i?.length||0}}));return console.log("âœ… Comments loaded from Supabase:",t.length),{data:t,error:null}}catch(a){return console.warn("ðŸ’¬ Error fetching comments from Supabase, using mock data:",a),{data:s(e),error:null}}},w=c(g,e=>l.postComments(e),120*1e3),f=async e=>{try{if(console.log("ðŸ’¬ Creating comment:",e),!u()||!o)return console.log("âš ï¸ Supabase not available, using mock"),{data:{id:Date.now().toString(),post_id:e.post_id,user_id:void 0,author_name:e.author_name||"Anonim",content:e.content,parent_id:e.parent_id,approved:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},error:null};const{data:{user:a}}=await o.auth.getUser();console.log("ðŸ‘¤ Current user for comment:",a?.email||"anonymous");const{data:r,error:t}=await o.from("comments").insert({post_id:e.post_id,user_id:a?.id,author_name:a?void 0:e.author_name,content:e.content,parent_id:e.parent_id,approved:!0}).select(`
        *,
        author:profiles(id, full_name, role, avatar_url)
      `).single();return t?(console.error("âŒ Error creating comment:",t),{data:null,error:t}):(p("comment",e.post_id),m.delete(l.postComments(e.post_id)),console.log("âœ… Comment created successfully:",r),{data:r,error:null})}catch(a){return console.error("âŒ Exception creating comment:",a),{data:null,error:a}}},s=e=>[{id:"1",post_id:e,user_id:"user-1",content:"Bu maqola juda foydali bo'ldi! Shifokorimga ko'rsatdim va u ham ma'qulladi. Rahmat!",approved:!0,created_at:new Date(Date.now()-864e5).toISOString(),updated_at:new Date(Date.now()-864e5).toISOString(),author:{id:"user-1",full_name:"Malika Karimova",role:"patient",avatar_url:"https://images.pexels.com/photos/774909/pexels-photo-774909.jpeg?auto=compress&cs=tinysrgb&w=100"},replies:[{id:"1-1",post_id:e,user_id:"doctor-1",content:"Xush kelibsiz! Agar qo'shimcha savollaringiz bo'lsa, bemalol so'rang.",parent_id:"1",approved:!0,created_at:new Date(Date.now()-432e5).toISOString(),updated_at:new Date(Date.now()-432e5).toISOString(),author:{id:"doctor-1",full_name:"Dr. Aziza Karimova",role:"doctor",avatar_url:"https://images.pexels.com/photos/5452201/pexels-photo-5452201.jpeg?auto=compress&cs=tinysrgb&w=100"}}],replies_count:1},{id:"2",post_id:e,author_name:"Anonim Bemor",content:"Menda ham shunga o'xshash belgilar bor. Qaysi shifokorga murojaat qilishim kerak?",approved:!0,created_at:new Date(Date.now()-1728e5).toISOString(),updated_at:new Date(Date.now()-1728e5).toISOString(),replies:[],replies_count:0},{id:"3",post_id:e,user_id:"user-3",content:"Juda tushunarli yozilgan. Oilamdagi boshqa a'zolarga ham ko'rsataman.",approved:!0,created_at:new Date(Date.now()-2592e5).toISOString(),updated_at:new Date(Date.now()-2592e5).toISOString(),author:{id:"user-3",full_name:"Akmal Toshmatov",role:"patient"},replies:[],replies_count:0}];export{h as T,f as c,w as g};
