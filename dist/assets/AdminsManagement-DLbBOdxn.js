import{m as H,a as J,r as d,K as Z,j as e,X as L,S as G,M as V,N as W,O as ee,P as te}from"./index-DtX8_sFx.js";import{P as re}from"./plus-D346WvM6.js";import{C as j}from"./check-circle-Bxw7JPnO.js";import{A as N}from"./alert-circle-CJoZj5dR.js";import{S as M}from"./search-gyIQzUfr.js";import{C as se}from"./clock-DjrY6wvX.js";import{S as ae}from"./square-pen-DcjaydtY.js";import{T as le}from"./trash-2-BY8n_M2x.js";import{E as T}from"./eye-off-BlL6kS9p.js";import{E}from"./eye-OnB_qZXO.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=H("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),pe=()=>{const{admin:o}=J(),[x,$]=d.useState([]),[v,w]=d.useState(!0),[p,D]=d.useState(""),[P,k]=d.useState(!1),[R,z]=d.useState(!1),[h,C]=d.useState(null),[u,b]=d.useState(!1),[A,S]=d.useState(null),[a,s]=d.useState({type:"",text:""}),[c,f]=d.useState(!1),[r,y]=d.useState({login:"",password:"",full_name:"",phone:"",role:"moderator"});d.useEffect(()=>{g()},[]);const g=async()=>{w(!0);try{const{data:t}=await Z();t&&$(t)}catch{s({type:"error",text:"Adminlarni yuklashda xatolik"})}finally{w(!1)}},n=t=>{const{name:i,value:l}=t.target;y(U=>({...U,[i]:l})),a.text&&s({type:"",text:""})},q=()=>{y({login:"",password:"",full_name:"",phone:"",role:"moderator"}),f(!1),C(null)},Y=()=>{q(),k(!0)},F=t=>{y({login:t.login,password:"",full_name:t.full_name,phone:t.phone||"",role:t.role}),C(t),z(!0)},m=()=>{k(!1),z(!1),q(),s({type:"",text:""})},O=async t=>{if(t.preventDefault(),!r.login.trim()){s({type:"error",text:"Login kiritilishi shart"});return}if(!r.password.trim()){s({type:"error",text:"Parol kiritilishi shart"});return}if(!r.full_name.trim()){s({type:"error",text:"To'liq ism kiritilishi shart"});return}b(!0),s({type:"",text:""});try{const{data:i,error:l}=await ee(r.login,r.password,r.full_name,r.phone,r.role);l?s({type:"error",text:l.message}):(s({type:"success",text:"Admin muvaffaqiyatli yaratildi!"}),await g(),setTimeout(()=>{m()},1500))}catch{s({type:"error",text:"Xatolik yuz berdi"})}finally{b(!1)}},X=async t=>{if(t.preventDefault(),!!h){b(!0),s({type:"",text:""});try{const{data:i,error:l}=await te(h.id,{login:r.login,password:r.password||void 0,full_name:r.full_name,phone:r.phone,role:r.role});l?s({type:"error",text:l.message}):(s({type:"success",text:"Admin muvaffaqiyatli yangilandi!"}),await g(),setTimeout(()=>{m()},1500))}catch{s({type:"error",text:"Xatolik yuz berdi"})}finally{b(!1)}}},B=async(t,i)=>{if(t===o?.id){s({type:"error",text:"O'zingizni o'chira olmaysiz!"});return}if(confirm(`${i} adminni o'chirishni xohlaysizmi?`)){S(t),s({type:"",text:""});try{const{error:l}=await W(t);l?s({type:"error",text:l.message}):(s({type:"success",text:"Admin muvaffaqiyatli o'chirildi!"}),await g())}catch{s({type:"error",text:"Xatolik yuz berdi"})}finally{S(null)}}},_=x.filter(t=>t.full_name.toLowerCase().includes(p.toLowerCase())||t.login.toLowerCase().includes(p.toLowerCase())),I=t=>{switch(t){case"admin":return"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200";case"moderator":return"bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200";default:return"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"}},K=t=>t==="admin"?de:V,Q=t=>new Date(t).toLocaleDateString("uz-UZ",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return v?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"theme-text-muted",children:"Adminlar yuklanmoqda..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold theme-text",children:"Adminlar Boshqaruvi"}),e.jsx("p",{className:"theme-text-secondary",children:"Admin panel foydalanuvchilarini boshqarish"})]}),o?.role==="admin"&&e.jsxs("button",{onClick:Y,className:"flex items-center space-x-2 theme-accent-bg text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200",children:[e.jsx(re,{size:20}),e.jsx("span",{children:"Yangi Admin"})]})]}),a.text&&e.jsxs("div",{className:`p-4 rounded-xl flex items-center space-x-2 animate-slide-down ${a.type==="success"?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800"}`,children:[a.type==="success"?e.jsx(j,{size:20,className:"text-green-600 dark:text-green-400"}):e.jsx(N,{size:20,className:"text-red-600 dark:text-red-400"}),e.jsx("span",{className:a.type==="success"?"text-green-700 dark:text-green-300":"text-red-700 dark:text-red-300",children:a.text})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"theme-bg rounded-lg theme-shadow theme-border border p-4",children:[e.jsx("div",{className:"text-2xl font-bold theme-text",children:x.length}),e.jsx("div",{className:"text-sm theme-text-secondary",children:"Jami adminlar"})]}),e.jsxs("div",{className:"theme-bg rounded-lg theme-shadow theme-border border p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:x.filter(t=>t.role==="admin").length}),e.jsx("div",{className:"text-sm theme-text-secondary",children:"Super adminlar"})]}),e.jsxs("div",{className:"theme-bg rounded-lg theme-shadow theme-border border p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:x.filter(t=>t.role==="moderator").length}),e.jsx("div",{className:"text-sm theme-text-secondary",children:"Moderatorlar"})]}),e.jsxs("div",{className:"theme-bg rounded-lg theme-shadow theme-border border p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:x.filter(t=>t.active).length}),e.jsx("div",{className:"text-sm theme-text-secondary",children:"Faol adminlar"})]})]}),e.jsx("div",{className:"theme-bg rounded-lg theme-shadow theme-border border p-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 theme-text-muted",size:20}),e.jsx("input",{type:"text",placeholder:"Adminlarni qidiring...",value:p,onChange:t=>D(t.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 theme-text"})]})}),e.jsx("div",{className:"theme-bg rounded-lg theme-shadow theme-border border overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y theme-border",children:[e.jsx("thead",{className:"theme-bg-secondary",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium theme-text-muted uppercase tracking-wider",children:"Admin"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium theme-text-muted uppercase tracking-wider",children:"Login"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium theme-text-muted uppercase tracking-wider",children:"Rol"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium theme-text-muted uppercase tracking-wider",children:"Telefon"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium theme-text-muted uppercase tracking-wider",children:"Holat"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium theme-text-muted uppercase tracking-wider",children:"Yaratilgan"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium theme-text-muted uppercase tracking-wider",children:"Amallar"})]})}),e.jsx("tbody",{className:"theme-bg divide-y theme-border",children:_.map((t,i)=>{const l=K(t.role);return e.jsxs("tr",{className:`${i%2===0?"bg-white":"bg-gray-50"} hover:bg-gray-100 transition-colors duration-200 border-b border-gray-200`,children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${t.role==="admin"?"bg-red-100 dark:bg-red-900":"bg-orange-100 dark:bg-orange-900"}`,children:e.jsx(l,{size:18,className:t.role==="admin"?"text-red-600 dark:text-red-400":"text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium theme-text",children:t.full_name}),e.jsx("div",{className:"text-sm theme-text-muted",children:t.id===o?.id&&e.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:"(Siz)"})})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm theme-text font-mono",children:["@",t.login]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full capitalize ${I(t.role)}`,children:t.role})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm theme-text",children:t.phone||"Kiritilmagan"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${t.active?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200"}`,children:t.active?"Faol":"Faol emas"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm theme-text-muted",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(se,{size:14}),e.jsx("span",{children:Q(t.created_at)})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("div",{className:"flex items-center justify-end space-x-2",children:o?.role==="admin"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>F(t),className:"theme-accent hover:text-blue-900 dark:hover:text-blue-300 p-2 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900 transition-colors duration-200",children:e.jsx(ae,{size:16})}),t.id!==o?.id&&e.jsx("button",{onClick:()=>B(t.id,t.full_name),disabled:A===t.id,className:"text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300 p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900 transition-colors duration-200 disabled:opacity-50",children:A===t.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}):e.jsx(le,{size:16})})]})})})]},t.id)})})]})})}),_.length===0&&!v&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"theme-text-muted mb-4",children:e.jsx(M,{size:48,className:"mx-auto"})}),e.jsx("h3",{className:"text-xl font-semibold theme-text-secondary mb-2",children:"Admin topilmadi"}),e.jsx("p",{className:"theme-text-muted",children:"Qidiruv so'zini o'zgartiring"})]}),P&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"theme-bg rounded-2xl theme-shadow-lg theme-border border p-8 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold theme-text",children:"Yangi Admin Qo'shish"}),e.jsx("button",{onClick:m,className:"theme-text-secondary hover:theme-text",children:e.jsx(L,{size:20})})]}),e.jsxs("form",{onSubmit:O,className:"space-y-4",children:[a.text&&e.jsxs("div",{className:`p-3 rounded-lg flex items-center space-x-2 ${a.type==="success"?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800"}`,children:[a.type==="success"?e.jsx(j,{size:16,className:"text-green-600 dark:text-green-400"}):e.jsx(N,{size:16,className:"text-red-600 dark:text-red-400"}),e.jsx("span",{className:`text-sm ${a.type==="success"?"text-green-700 dark:text-green-300":"text-red-700 dark:text-red-300"}`,children:a.text})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Login *"}),e.jsx("input",{type:"text",name:"login",value:r.login,onChange:n,required:!0,className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 theme-text",placeholder:"admin_login"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Parol *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:c?"text":"password",name:"password",value:r.password,onChange:n,required:!0,className:"w-full px-4 py-3 pr-10 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 theme-text",placeholder:"••••••••"}),e.jsx("button",{type:"button",onClick:()=>f(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 theme-text-muted hover:theme-accent",children:c?e.jsx(T,{size:16}):e.jsx(E,{size:16})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"To'liq ism *"}),e.jsx("input",{type:"text",name:"full_name",value:r.full_name,onChange:n,required:!0,className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 theme-text",placeholder:"Admin ismi"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Telefon"}),e.jsx("input",{type:"tel",name:"phone",value:r.phone,onChange:n,className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 theme-text",placeholder:"+998 90 123 45 67"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Rol *"}),e.jsxs("select",{name:"role",value:r.role,onChange:n,className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 theme-text appearance-none",children:[e.jsx("option",{value:"moderator",children:"Moderator"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:m,className:"flex-1 theme-border border theme-text-secondary px-4 py-2 rounded-lg hover:theme-bg-tertiary transition-colors duration-200",children:"Bekor qilish"}),e.jsx("button",{type:"submit",disabled:u,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200 disabled:opacity-50",children:u?"Yaratilmoqda...":"Yaratish"})]})]})]})}),R&&h&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"theme-bg rounded-2xl theme-shadow-lg theme-border border p-8 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold theme-text",children:"Admin Tahrirlash"}),e.jsx("button",{onClick:m,className:"theme-text-secondary hover:theme-text",children:e.jsx(L,{size:20})})]}),e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[a.text&&e.jsxs("div",{className:`p-3 rounded-lg flex items-center space-x-2 ${a.type==="success"?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800"}`,children:[a.type==="success"?e.jsx(j,{size:16,className:"text-green-600 dark:text-green-400"}):e.jsx(N,{size:16,className:"text-red-600 dark:text-red-400"}),e.jsx("span",{className:`text-sm ${a.type==="success"?"text-green-700 dark:text-green-300":"text-red-700 dark:text-red-300"}`,children:a.text})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Login"}),e.jsx("input",{type:"text",name:"login",value:r.login,onChange:n,required:!0,className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 theme-text"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Yangi parol (bo'sh qoldiring agar o'zgartirmoqchi bo'lmasangiz)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:c?"text":"password",name:"password",value:r.password,onChange:n,className:"w-full px-4 py-3 pr-10 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 theme-text",placeholder:"Yangi parol"}),e.jsx("button",{type:"button",onClick:()=>f(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 theme-text-muted hover:theme-accent",children:c?e.jsx(T,{size:16}):e.jsx(E,{size:16})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"To'liq ism"}),e.jsx("input",{type:"text",name:"full_name",value:r.full_name,onChange:n,required:!0,className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 theme-text"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Telefon"}),e.jsx("input",{type:"tel",name:"phone",value:r.phone,onChange:n,className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 theme-text"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Rol"}),e.jsxs("select",{name:"role",value:r.role,onChange:n,disabled:h?.id===o?.id,className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 theme-text appearance-none disabled:opacity-50",children:[e.jsx("option",{value:"moderator",children:"Moderator"}),e.jsx("option",{value:"admin",children:"Admin"})]}),h?.id===o?.id&&e.jsx("p",{className:"text-xs theme-text-muted mt-1",children:"O'z rolingizni o'zgartira olmaysiz"})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:m,className:"flex-1 theme-border border theme-text-secondary px-4 py-2 rounded-lg hover:theme-bg-tertiary transition-colors duration-200",children:"Bekor qilish"}),e.jsx("button",{type:"submit",disabled:u,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200 disabled:opacity-50",children:u?"Saqlanmoqda...":"Saqlash"})]})]})]})}),o?.role!=="admin"&&e.jsx("div",{className:"theme-bg rounded-lg theme-shadow theme-border border p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(G,{size:20,className:"text-orange-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold theme-text",children:"Cheklangan Ruxsat"}),e.jsx("p",{className:"theme-text-secondary text-sm",children:"Siz moderator sifatida faqat adminlar ro'yxatini ko'rishingiz mumkin. Yangi admin qo'shish yoki tahrirlash uchun admin huquqi kerak."})]})]})})]})};export{pe as default};
