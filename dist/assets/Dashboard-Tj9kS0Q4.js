import{c as I,r as c,i as F,h as H,F as h,f as u,j as e,A as j,e as V,L as f,H as q}from"./index-DO34fR0A.js";import{g as B}from"./adminUsers-BGpPnm0u.js";import{g as Y}from"./patientStories-B8UZuO7S.js";import{g as Z}from"./notifications-BFjoIerH.js";import{T as k}from"./trending-up-O1vFHddg.js";import{M as J}from"./message-square-DDKqcEs4.js";import{C as K}from"./clock-mDGFTiaF.js";import{A as p}from"./arrow-up-right-BcC5rWPk.js";import{E as _}from"./eye-BSzZDvbN.js";import{C as O}from"./check-circle-DItbFGDG.js";import{I as Q}from"./image-DXH4GN0n.js";import{V as W}from"./video-BNTWfBdF.js";const oe=()=>{const{t:s}=I(),[m,D]=c.useState([]),[x,A]=c.useState([]),[S,U]=c.useState([]),[g,T]=c.useState([]),[b,P]=c.useState([]),[$,N]=c.useState(!0),[C,L]=c.useState(new Date);c.useEffect(()=>{y()},[]);const y=async()=>{N(!0);try{const[t,a,d,r,l]=await Promise.all([F("uz",{}),B(),H("uz"),Y("uz"),Z()]);t.data&&D(t.data),a.data&&A(a.data),d.data&&U(d.data),r.data&&T(r.data),l.data&&P(l.data),L(new Date)}catch(t){console.error("Error loading dashboard data:",t)}finally{N(!1)}},i=(()=>{const t=m.reduce((l,n)=>l+(n.views_count||0),0),a=m.filter(l=>l.published),d=S.filter(l=>l.active&&l.verified);g.filter(l=>l.published);const r=l=>{const n=Math.floor(l*.85);return n===0?"0.0":((l-n)/n*100).toFixed(1)};return{totalUsers:x.length,totalViews:t,totalPosts:a.length,totalDoctors:d.length,userGrowth:r(x.length),viewGrowth:r(t),postGrowth:r(a.length),doctorGrowth:r(d.length)}})(),v=m.sort((t,a)=>new Date(a.created_at).getTime()-new Date(t.created_at).getTime()).slice(0,5).map(t=>({id:t.id,title:t.title,author:t.author?.full_name||"Noma'lum",views:t.views_count||0,status:t.published?"published":"draft",date:new Date(t.created_at).toLocaleDateString("uz-UZ"),type:t.youtube_url?"video":t.featured_image_url?"image":"text"})),w=x.sort((t,a)=>new Date(a.created_at).getTime()-new Date(t.created_at).getTime()).slice(0,5).map(t=>({id:t.id,name:t.user_metadata?.full_name||t.user_metadata?.name||t.email?.split("@")[0]||"User",email:t.email,role:t.user_metadata?.role||"patient",joinDate:new Date(t.created_at).toLocaleDateString("uz-UZ"),avatar:(t.user_metadata?.full_name||t.email?.split("@")[0]||"U").charAt(0).toUpperCase(),provider:t.app_metadata?.provider||"email"})),z=[...m.slice(0,2).map(t=>({id:`post-${t.id}`,user:t.author?.full_name||"Noma'lum muallif",action:t.published?s("publishedArticle"):s("createdDraft"),target:t.title,time:o(t.published_at||t.created_at),color:t.published?"bg-green-500":"bg-yellow-500"})),...x.slice(0,2).map(t=>({id:`user-${t.id}`,user:t.user_metadata?.full_name||t.email?.split("@")[0]||"Foydalanuvchi",action:s("registered"),target:`${t.user_metadata?.role||"patient"} sifatida`,time:o(t.created_at),color:"bg-blue-500"})),...g.slice(0,1).map(t=>({id:`story-${t.id}`,user:"Admin",action:s("addedPatientStory"),target:t.patient_name,time:o(t.created_at),color:"bg-purple-500"})),...b.slice(0,1).map(t=>({id:`notification-${t.id}`,user:t.creator?.full_name||"System",action:s("sentNotification"),target:t.title,time:o(t.sent_at),color:"bg-orange-500"}))].sort((t,a)=>new Date(a.time).getTime()-new Date(t.time).getTime()).slice(0,8);function o(t){const a=new Date(t),r=(new Date().getTime()-a.getTime())/(1e3*60*60);return r<1?`${Math.floor(r*60)} ${s("minutesAgo")}`:r<24?`${Math.floor(r)} ${s("hoursAgo")}`:`${Math.floor(r/24)} ${s("daysAgo")}`}const M=[{name:s("newArticle"),icon:h,color:"bg-primary-500",href:"/admin/posts/create"},{name:s("users"),icon:u,color:"bg-primary-500",href:"/admin/users"},{name:s("analytics"),icon:k,color:"bg-primary-500",href:"/admin/analytics"},{name:s("notifications"),icon:J,color:"bg-primary-500",href:"/admin/notifications"}],G=t=>{switch(t){case"video":return W;case"image":return Q;default:return h}},R=t=>{switch(t){case"video":return"text-red-600";case"image":return"text-green-600";default:return"text-blue-600"}},E=t=>t==="google"?e.jsx("div",{className:"w-4 h-4 bg-white rounded-full flex items-center justify-center shadow-sm",children:e.jsxs("svg",{className:"w-3 h-3",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}):"ðŸ“§";return $?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"theme-text-muted",children:s("dashboardLoading")})]})}):e.jsxs("div",{className:"space-y-4 lg:space-y-6 xl:space-y-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-2 lg:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl lg:text-2xl font-bold theme-text",children:s("dashboardTitle")}),e.jsx("p",{className:"theme-text-secondary mt-1 text-sm lg:text-base",children:s("dashboardSubtitle")})]}),e.jsxs("div",{className:"flex items-center space-x-3 lg:space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-xs lg:text-sm theme-text-muted",children:[e.jsx(K,{size:16}),e.jsxs("span",{children:[s("lastUpdate")," ",C.toLocaleTimeString("uz-UZ")]})]}),e.jsxs("button",{onClick:y,className:"flex items-center space-x-2 theme-accent-bg text-white px-3 lg:px-4 py-2 lg:py-2.5 rounded-lg hover:bg-blue-700 transition-colors duration-200 text-sm",children:[e.jsx(j,{size:16}),e.jsx("span",{children:s("refresh")})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6",children:[e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border p-4 lg:p-6 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 lg:p-3 rounded-xl bg-primary-100 dark:bg-primary-900/20",children:e.jsx(u,{size:20,className:"lg:size-22 text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(p,{size:14,className:"text-secondary-500"}),e.jsxs("span",{className:"text-xs lg:text-sm font-medium text-secondary-600 dark:text-secondary-400",children:["+",i.userGrowth,"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl lg:text-2xl font-bold theme-text mb-1",children:i.totalUsers.toLocaleString()}),e.jsx("p",{className:"text-xs lg:text-sm theme-text-secondary",children:s("totalUsers")})]})]}),e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border p-4 lg:p-6 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 lg:p-3 rounded-xl bg-primary-100 dark:bg-primary-900/20",children:e.jsx(h,{size:20,className:"lg:size-22 text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(p,{size:14,className:"text-secondary-500"}),e.jsxs("span",{className:"text-xs lg:text-sm font-medium text-secondary-600 dark:text-secondary-400",children:["+",i.postGrowth,"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl lg:text-2xl font-bold theme-text mb-1",children:i.totalPosts}),e.jsx("p",{className:"text-xs lg:text-sm theme-text-secondary",children:s("publishedArticles")})]})]}),e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border p-4 lg:p-6 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 lg:p-3 rounded-xl bg-primary-100 dark:bg-primary-900/20",children:e.jsx(_,{size:20,className:"lg:size-22 text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(p,{size:14,className:"text-secondary-500"}),e.jsxs("span",{className:"text-xs lg:text-sm font-medium text-secondary-600 dark:text-secondary-400",children:["+",i.viewGrowth,"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl lg:text-2xl font-bold theme-text mb-1",children:i.totalViews.toLocaleString()}),e.jsx("p",{className:"text-xs lg:text-sm theme-text-secondary",children:s("totalViews")})]})]}),e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border p-4 lg:p-6 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 lg:p-3 rounded-xl bg-primary-100 dark:bg-primary-900/20",children:e.jsx(V,{size:20,className:"lg:size-22 text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(p,{size:14,className:"text-secondary-500"}),e.jsxs("span",{className:"text-xs lg:text-sm font-medium text-secondary-600 dark:text-secondary-400",children:["+",i.doctorGrowth,"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl lg:text-2xl font-bold theme-text mb-1",children:i.totalDoctors}),e.jsx("p",{className:"text-xs lg:text-sm theme-text-secondary",children:s("activeDoctors")})]})]})]}),e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border p-4 lg:p-6",children:[e.jsx("h2",{className:"text-lg lg:text-xl font-bold theme-text mb-4 lg:mb-6",children:s("quickActions")}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 lg:gap-4",children:M.map(t=>{const a=t.icon;return e.jsxs(f,{to:t.href,className:`${t.color} text-white p-4 lg:p-5 rounded-xl hover:opacity-90 transition-all duration-200 transform hover:scale-105 block`,children:[e.jsx(a,{size:20,className:"lg:size-22 mb-2 lg:mb-3 mx-auto"}),e.jsx("div",{className:"text-xs lg:text-sm font-medium text-center",children:t.name})]},t.name)})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-6",children:[e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border",children:[e.jsx("div",{className:"p-4 lg:p-6 theme-border border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg lg:text-xl font-bold theme-text",children:s("recentArticles")}),e.jsx(f,{to:"/admin/posts",className:"text-xs lg:text-sm theme-accent hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:s("viewAll")})]})}),e.jsx("div",{className:"p-4 lg:p-6",children:e.jsx("div",{className:"space-y-4",children:v.length>0?v.map(t=>{const a=G(t.type);return e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between p-4 theme-bg-tertiary rounded-xl transition-all duration-200 space-y-2 lg:space-y-0",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(a,{size:16,className:`${R(t.type)}`}),e.jsx("p",{className:"text-sm font-semibold theme-text line-clamp-2 lg:truncate",children:t.title})]}),e.jsxs("p",{className:"text-sm theme-text-muted mb-2",children:[t.author," ",s("by")]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs theme-text-muted",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(_,{size:12}),e.jsxs("span",{children:[t.views.toLocaleString()," ",s("views")]})]}),e.jsx("span",{children:t.date})]})]}),e.jsx("div",{className:"lg:ml-4 flex-shrink-0",children:e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${t.status==="published"?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200"}`,children:t.status==="published"?s("published"):s("draft")})})]},t.id)}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(h,{size:32,className:"theme-text-muted mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"theme-text-secondary text-sm",children:s("noArticlesYet")})]})})})]}),e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border",children:[e.jsx("div",{className:"p-4 lg:p-6 theme-border border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg lg:text-xl font-bold theme-text",children:s("recentUsers")}),e.jsx(f,{to:"/admin/users",className:"text-xs lg:text-sm theme-accent hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:s("viewAll")})]})}),e.jsx("div",{className:"p-4 lg:p-6",children:e.jsx("div",{className:"space-y-4",children:w.length>0?w.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-4 theme-bg-tertiary rounded-xl transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 lg:w-10 lg:h-10 bg-primary-500 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-sm font-semibold text-white",children:t.avatar})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"text-sm font-semibold theme-text truncate",children:t.name}),E(t.provider)]}),e.jsx("p",{className:"text-xs theme-text-muted truncate",children:t.email})]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("span",{className:"px-3 py-1 text-xs font-medium rounded-full capitalize bg-primary-500 text-white",children:t.role}),e.jsx("div",{className:"text-xs theme-text-muted mt-1 hidden lg:block",children:t.joinDate})]})]},t.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(u,{size:32,className:"theme-text-muted mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"theme-text-secondary text-sm",children:s("noUsersYet")})]})})})]})]}),e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border",children:[e.jsx("div",{className:"p-4 lg:p-6 theme-border border-b",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{size:18,className:"lg:size-20 theme-accent"}),e.jsx("h2",{className:"text-lg lg:text-xl font-bold theme-text",children:s("recentActivity")})]})}),e.jsx("div",{className:"p-4 lg:p-6",children:e.jsx("div",{className:"space-y-4",children:z.length>0?z.map(t=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`w-2 h-2 ${t.color} rounded-full mt-2 flex-shrink-0`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm theme-text",children:[e.jsx("span",{className:"font-semibold",children:t.user})," ",t.action,t.target&&e.jsxs("span",{className:"font-medium",children:[' "',t.target,'"']})]}),e.jsx("p",{className:"text-xs theme-text-muted",children:t.time})]})]},t.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(j,{size:32,className:"theme-text-muted mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"theme-text-secondary text-sm",children:s("noActivityYet")})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 lg:gap-6",children:[e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border p-4 lg:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-base lg:text-lg font-semibold theme-text",children:s("systemStatus")}),e.jsx(O,{size:18,className:"text-secondary-500"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:"Server"}),e.jsx("span",{className:"text-sm font-medium text-secondary-600 dark:text-secondary-400",children:s("online")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:s("database")}),e.jsx("span",{className:"text-sm font-medium text-secondary-600 dark:text-secondary-400",children:s("connected")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:s("memory")}),e.jsxs("span",{className:"text-sm font-medium text-secondary-600 dark:text-secondary-400",children:["78% ",s("used")]})]})]})]}),e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border p-4 lg:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-base lg:text-lg font-semibold theme-text",children:s("performance")}),e.jsx(k,{size:18,className:"text-primary-500"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:s("responseTime")}),e.jsx("span",{className:"text-sm font-medium theme-text",children:"245ms"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:s("uptime")}),e.jsx("span",{className:"text-sm font-medium theme-text",children:"99.9%"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:s("load")}),e.jsx("span",{className:"text-sm font-medium theme-text",children:s("low")})]})]})]}),e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border p-4 lg:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-base lg:text-lg font-semibold theme-text",children:s("content")}),e.jsx(q,{size:18,className:"text-secondary-500"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:s("patientStories")}),e.jsx("span",{className:"text-sm font-medium theme-text",children:g.filter(t=>t.published).length})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:s("categories")}),e.jsx("span",{className:"text-sm font-medium theme-text",children:"6"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:s("notifications")}),e.jsx("span",{className:"text-sm font-medium theme-text",children:b.filter(t=>t.active).length})]})]})]})]})]})};export{oe as default};
