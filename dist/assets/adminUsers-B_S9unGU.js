import{ak as q,r as n,a2 as R,al as U,j as t,am as _,b as D,an as k}from"./adminCore-BtA5lFAk.js";import{U as A,e as B,f as P,g as T,h as E}from"./shared-Bjo-oKY7.js";import"./adminOther-BNf-f8fR.js";import"./doctor-RVMPESH5.js";import"./publicCore-BUSXeirZ.js";const Y=()=>{q();const[l,x]=n.useState([]),[a,g]=n.useState([]),[p,i]=n.useState(!0),[c,f]=n.useState(""),[d,j]=n.useState("all"),[u,v]=n.useState("all"),[h,b]=n.useState(""),[m,S]=n.useState("all");n.useEffect(()=>{y()},[]);const y=async()=>{i(!0);try{const[e,s]=await Promise.all([R(),U()]);e.data&&x(e.data),s.data&&g(s.data)}catch(e){console.error("Error loading data:",e)}finally{i(!1)}},N={total:l.length,confirmed:l.filter(e=>e.email_confirmed_at).length,unconfirmed:l.filter(e=>!e.email_confirmed_at).length,emailUsers:l.filter(e=>e.app_metadata?.provider==="email").length,googleUsers:l.filter(e=>e.app_metadata?.provider==="google").length,recentSignups:l.filter(e=>{const s=new Date;return s.setDate(s.getDate()-7),new Date(e.created_at)>s}).length},w={total:a.length,pending:a.filter(e=>e.status==="pending").length,contacted:a.filter(e=>e.status==="contacted").length,completed:a.filter(e=>e.status==="completed").length,cancelled:a.filter(e=>e.status==="cancelled").length,recent:a.filter(e=>{const s=new Date;return s.setDate(s.getDate()-7),new Date(e.created_at)>s}).length},C={total:l.length,byRole:l.reduce((e,s)=>{const o=s.user_metadata?.role||"patient";return e[o]=(e[o]||0)+1,e},{}),byProvider:l.reduce((e,s)=>{const o=s.app_metadata?.provider||"email";return e[o]=(e[o]||0)+1,e},{})},r={total:a.length,pending:a.filter(e=>e.status==="pending").length,contacted:a.filter(e=>e.status==="contacted").length,completed:a.filter(e=>e.status==="completed").length,cancelled:a.filter(e=>e.status==="cancelled").length};return p?t.jsx("div",{className:"flex items-center justify-center py-16",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),t.jsx("p",{className:"theme-text-muted",children:"Foydalanuvchilar yuklanmoqda..."})]})}):t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold theme-text",children:"Foydalanuvchilar Boshqaruvi"}),t.jsx("p",{className:"theme-text-secondary",children:"Supabase Auth foydalanuvchilarini boshqarish"})]})}),t.jsx(A,{stats:N}),t.jsx(B,{searchTerm:c,selectedRole:d,selectedProvider:u,onSearchChange:f,onRoleChange:j,onProviderChange:v,userCounts:C}),t.jsx(P,{searchTerm:c,selectedRole:d,selectedProvider:u}),t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsxs("h2",{className:"text-xl font-bold theme-text flex items-center space-x-2",children:[t.jsx(_,{size:20,className:"text-primary-600"}),t.jsx("span",{children:"Bepul Maslahat So'rovlari"})]}),t.jsx("p",{className:"theme-text-secondary text-sm",children:"Saytdan kelgan maslahat so'rovlari"})]})}),t.jsx(T,{stats:w}),t.jsx("div",{className:"theme-bg rounded-lg theme-shadow theme-border border p-6",children:t.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[t.jsx(D,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 theme-text-muted",size:20}),t.jsx("input",{type:"text",placeholder:"Maslahat so'rovlarini qidiring...",value:h,onChange:e=>b(e.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 theme-text"})]})}),t.jsx("div",{className:"lg:w-48",children:t.jsxs("div",{className:"relative",children:[t.jsx(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 theme-text-muted",size:20}),t.jsxs("select",{value:m,onChange:e=>S(e.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 appearance-none theme-text",children:[t.jsxs("option",{value:"all",children:["Barcha holatlar (",r.total,")"]}),t.jsxs("option",{value:"pending",children:["Kutilmoqda (",r.pending,")"]}),t.jsxs("option",{value:"contacted",children:["Bog'lanildi (",r.contacted,")"]}),t.jsxs("option",{value:"completed",children:["Yakunlandi (",r.completed,")"]}),t.jsxs("option",{value:"cancelled",children:["Bekor qilindi (",r.cancelled,")"]})]})]})})]})}),t.jsx(E,{searchTerm:h,selectedStatus:m})]})]})};export{Y as default};
