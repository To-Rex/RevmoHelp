import{r as c,j as e,U as ae,e as F,H as re,F as ie,X as C,A as le,h as ne}from"./index-BLJsMvxT.js";import{g as oe,d as de,c as ce,u as me}from"./patientStories-DeZDe60F.js";import{g as xe,a as he,b as ue}from"./patientStoryHelpers-DsDAgItP.js";import{S as H}from"./star-DJItZpmU.js";import{I as be}from"./image-BNEUy3Hs.js";import{V as pe}from"./video-BoQwYvsc.js";import{U as ge}from"./upload-8R9VAxzC.js";import{P as T}from"./plus-DE2nvxC4.js";import{P as fe}from"./pill-DjSx1zg6.js";import{C as je}from"./check-circle-DLzRG-NL.js";import{A as ye}from"./alert-circle-Ch-X4D41.js";import{S as G}from"./search-BZ6vZID7.js";import{P as ve}from"./play-kajXgAYU.js";import{C as Ne}from"./clock-CK2-NyCC.js";import{C as _e}from"./calendar-BnYvyjRp.js";import{C as we}from"./credit-card-Df4VYXk5.js";import{E as ke}from"./eye-CGZ2FPCT.js";import{T as ze}from"./trash-2-BEPc6_q0.js";import{A as Ce}from"./award-Cj83oTIn.js";import{S as I}from"./save-B3aZFzp_.js";const J=({formData:a,doctors:B,onInputChange:m,onFormDataChange:A,imagePreview:S,onImageUpload:M,onRemoveImage:j})=>{const[y,v]=c.useState(""),[N,g]=c.useState(""),[_,P]=c.useState(""),[n,R]=c.useState("uz"),U=(s,r)=>{const x=r.translations||{},u=x[s]||{patient_name:"",diagnosis:"",story_content:"",treatment_duration:"",outcome:"",doctor_name:r.doctor_name||"",symptoms:r.symptoms||[],treatment_methods:r.treatment_methods||[],medications:r.medications||[],lifestyle_changes:r.lifestyle_changes||"",meta_title:"",meta_description:""};return{current:x,langObj:u}},b=(s,r)=>{if(n==="uz"){m(s,r);return}const x=n;A(u=>{const{current:k,langObj:L}=U(x,u);return{...u,translations:{...k,[x]:{...L,[s]:r}}}})},h=s=>{if(n==="uz")return a[s]??"";const r=n;return a.translations?.[r]?.[s]??""},f=()=>{y.trim()&&!a.symptoms.includes(y.trim())&&(m("symptoms",[...a.symptoms,y.trim()]),v(""))},w=s=>{m("symptoms",a.symptoms.filter(r=>r!==s))},q=()=>{N.trim()&&!a.treatment_methods.includes(N.trim())&&(m("treatment_methods",[...a.treatment_methods,N.trim()]),g(""))},E=s=>{m("treatment_methods",a.treatment_methods.filter(r=>r!==s))},p=()=>{_.trim()&&!a.medications.includes(_.trim())&&(m("medications",[...a.medications,_.trim()]),P(""))},l=s=>{m("medications",a.medications.filter(r=>r!==s))};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary",children:"Til"}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-800 rounded-lg p-1 overflow-x-auto",children:[{code:"uz",label:"O'zbek",flag:"ðŸ‡ºðŸ‡¿"},{code:"ru",label:"Ð ÑƒÑÑÐºÐ¸Ð¹",flag:"ðŸ‡·ðŸ‡º"},{code:"en",label:"English",flag:"ðŸ‡ºðŸ‡¸"}].map(s=>e.jsxs("button",{type:"button",onClick:()=>R(s.code),className:`px-3 py-2 text-sm font-medium rounded-md transition-all duration-200 flex items-center space-x-2 whitespace-nowrap ${n===s.code?"bg-white dark:bg-gray-700 theme-text shadow-sm":"theme-text-secondary hover:theme-text"}`,children:[e.jsx("span",{children:s.flag}),e.jsx("span",{className:"hidden sm:inline",children:s.label})]},s.code))})]})}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold theme-text mb-4 flex items-center space-x-2",children:[e.jsx(ae,{size:20,className:"text-blue-600"}),e.jsx("span",{children:"Asosiy Ma'lumotlar"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:["Bemor ismi * ",n!=="uz"&&e.jsxs("span",{className:"theme-text-muted",children:["(",n.toUpperCase(),")"]})]}),e.jsx("input",{type:"text",value:h("patient_name"),onChange:s=>b("patient_name",s.target.value),required:!0,className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text",placeholder:"Bemor to'liq ismi"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Yoshi *"}),e.jsx("input",{type:"number",value:a.age,onChange:s=>m("age",parseInt(s.target.value)||0),required:!0,min:"1",max:"120",className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:["Tashxis * ",n!=="uz"&&e.jsxs("span",{className:"theme-text-muted",children:["(",n.toUpperCase(),")"]})]}),e.jsx("input",{type:"text",value:h("diagnosis"),onChange:s=>b("diagnosis",s.target.value),required:!0,className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text",placeholder:"Kasallik tashxisi"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Davolash shifokor *"}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 theme-text-muted",size:16}),e.jsxs("select",{value:a.doctor_name,onChange:s=>m("doctor_name",s.target.value),required:!0,className:"w-full pl-10 pr-4 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text appearance-none",children:[e.jsx("option",{value:"",children:"Shifokorni tanlang"}),B.map(s=>e.jsxs("option",{value:s.full_name,children:[s.full_name," - ",s.specialization]},s.id))]})]}),B.length===0&&e.jsx("p",{className:"text-xs theme-text-muted mt-1",children:"Hozircha shifokorlar mavjud emas. Avval shifokor qo'shing."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:["Davolash muddati * ",n!=="uz"&&e.jsxs("span",{className:"theme-text-muted",children:["(",n.toUpperCase(),")"]})]}),e.jsx("input",{type:"text",value:h("treatment_duration"),onChange:s=>b("treatment_duration",s.target.value),required:!0,className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text",placeholder:"Masalan: 6 oy, 1 yil"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Reyting *"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>m("rating",s),className:`p-1 transition-colors duration-200 ${s<=a.rating?"text-yellow-500":"text-gray-300"}`,children:e.jsx(H,{size:20,className:s<=a.rating?"fill-current":""})},s))}),e.jsxs("span",{className:"text-sm theme-text-secondary",children:["(",a.rating,"/5)"]})]})]})]})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold theme-text mb-4 flex items-center space-x-2",children:[e.jsx(re,{size:20,className:"text-red-600"}),e.jsx("span",{children:"Bemor Hikoyasi"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:["Hikoya matni * ",n!=="uz"&&e.jsxs("span",{className:"theme-text-muted",children:["(",n.toUpperCase(),")"]})]}),e.jsx("textarea",{value:h("story_content"),onChange:s=>b("story_content",s.target.value),required:!0,rows:6,className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text resize-none",placeholder:"Bemorning to'liq hikoyasini yozing..."}),e.jsxs("div",{className:"text-xs theme-text-muted mt-1",children:[h("story_content").length," belgi"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:["Davolash natijasi * ",n!=="uz"&&e.jsxs("span",{className:"theme-text-muted",children:["(",n.toUpperCase(),")"]})]}),e.jsx("textarea",{value:h("outcome"),onChange:s=>b("outcome",s.target.value),required:!0,rows:3,className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text resize-none",placeholder:"Davolash natijasi va hozirgi holat"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Turmush tarzi o'zgarishlari"}),e.jsx("textarea",{value:a.lifestyle_changes,onChange:s=>m("lifestyle_changes",s.target.value),rows:3,className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text resize-none",placeholder:"Ovqatlanish, mashqlar, kundalik rejim o'zgarishlari"})]})]})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold theme-text mb-4",children:"Kontent Turi"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[{type:"text",icon:ie,label:"Matn Hikoyasi"},{type:"image",icon:be,label:"Rasm Hikoyasi"},{type:"video",icon:pe,label:"Video Hikoya"}].map(({type:s,icon:r,label:x})=>e.jsxs("button",{type:"button",onClick:()=>m("content_type",s),className:`p-4 border-2 rounded-lg transition-all duration-200 ${a.content_type===s?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"theme-border hover:border-gray-300 dark:hover:border-gray-500 theme-text-secondary"}`,children:[e.jsx(r,{size:24,className:"mx-auto mb-2"}),e.jsx("div",{className:"text-sm font-medium",children:x})]},s))})]}),(a.content_type==="image"||a.content_type==="video")&&e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6 animate-fade-in",children:[a.content_type==="image"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-4",children:"Hikoya rasmi"}),S?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:S,alt:"Preview",className:"w-full h-48 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:j,className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors duration-200",children:e.jsx(C,{size:16})})]}):e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-48 border-2 theme-border border-dashed rounded-lg cursor-pointer theme-bg-tertiary hover:theme-bg-quaternary transition-colors duration-200",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx(ge,{className:"w-8 h-8 mb-4 theme-text-muted"}),e.jsxs("p",{className:"mb-2 text-sm theme-text-secondary",children:[e.jsx("span",{className:"font-semibold",children:"Yuklash uchun bosing"})," yoki sudrab tashlang"]}),e.jsx("p",{className:"text-xs theme-text-muted",children:"PNG, JPG, WEBP (max 5MB)"})]}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:M})]})]}),a.content_type==="video"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"YouTube Video URL"}),e.jsx("input",{type:"url",placeholder:"https://www.youtube.com/watch?v=...",value:a.youtube_url||"",onChange:s=>m("youtube_url",s.target.value),className:"w-full px-4 py-3 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold theme-text mb-4 flex items-center space-x-2",children:[e.jsx(le,{size:20,className:"text-orange-600"}),e.jsx("span",{children:"Kasallik Belgilari"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",placeholder:"Yangi belgi qo'shish",value:y,onChange:s=>v(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),f()),className:"flex-1 px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text text-sm"}),e.jsx("button",{type:"button",onClick:f,className:"px-3 py-2 theme-accent-bg text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:e.jsx(T,{size:16})})]}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:a.symptoms.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-orange-50 dark:bg-orange-900/20 text-orange-800 dark:text-orange-200 rounded-lg text-sm",children:[e.jsx("span",{children:s}),e.jsx("button",{type:"button",onClick:()=>w(s),className:"text-orange-600 dark:text-orange-400 hover:text-orange-800 dark:hover:text-orange-300",children:e.jsx(C,{size:14})})]},r))})]})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold theme-text mb-4 flex items-center space-x-2",children:[e.jsx(F,{size:20,className:"text-blue-600"}),e.jsx("span",{children:"Davolash Usullari"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",placeholder:"Davolash usuli qo'shish",value:N,onChange:s=>g(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),q()),className:"flex-1 px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text text-sm"}),e.jsx("button",{type:"button",onClick:q,className:"px-3 py-2 theme-accent-bg text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:e.jsx(T,{size:16})})]}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:a.treatment_methods.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-blue-50 dark:bg-blue-900/20 text-blue-800 dark:text-blue-200 rounded-lg text-sm",children:[e.jsx("span",{children:s}),e.jsx("button",{type:"button",onClick:()=>E(s),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",children:e.jsx(C,{size:14})})]},r))})]})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold theme-text mb-4 flex items-center space-x-2",children:[e.jsx(fe,{size:20,className:"text-green-600"}),e.jsx("span",{children:"Dorilar"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",placeholder:"Dori qo'shish",value:_,onChange:s=>P(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),p()),className:"flex-1 px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text text-sm"}),e.jsx("button",{type:"button",onClick:p,className:"px-3 py-2 theme-accent-bg text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:e.jsx(T,{size:16})})]}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:a.medications.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-200 rounded-lg text-sm",children:[e.jsx("span",{children:s}),e.jsx("button",{type:"button",onClick:()=>l(s),className:"text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300",children:e.jsx(C,{size:14})})]},r))})]})]})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold theme-text mb-4",children:"SEO Sozlamalari"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:["Meta sarlavha ",n!=="uz"&&e.jsxs("span",{className:"theme-text-muted",children:["(",n.toUpperCase(),")"]})]}),e.jsx("input",{type:"text",value:h("meta_title"),onChange:s=>b("meta_title",s.target.value),className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text",placeholder:"SEO uchun sarlavha"}),e.jsxs("div",{className:"text-xs theme-text-muted mt-1",children:[h("meta_title").length,"/60 belgi"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:["Meta tavsif ",n!=="uz"&&e.jsxs("span",{className:"theme-text-muted",children:["(",n.toUpperCase(),")"]})]}),e.jsx("textarea",{value:h("meta_description"),onChange:s=>b("meta_description",s.target.value),rows:2,className:"w-full px-3 py-2 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text resize-none",placeholder:"SEO uchun qisqacha tavsif"}),e.jsxs("div",{className:"text-xs theme-text-muted mt-1",children:[h("meta_description").length,"/160 belgi"]})]})]})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold theme-text mb-4",children:"Nashr Sozlamalari"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"published",checked:a.published,onChange:s=>m("published",s.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"published",className:"text-sm font-medium theme-text-secondary",children:"Darhol nashr etish"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"featured",checked:a.featured,onChange:s=>m("featured",s.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"featured",className:"text-sm font-medium theme-text-secondary",children:"Asosiy hikoya"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium theme-text-secondary mb-2",children:"Tartib raqami"}),e.jsx("div",{className:"w-full px-3 py-2 theme-border border rounded-lg theme-bg theme-text text-sm",children:"Avtomatik belgilanadi"})]})]})]})]})},We=()=>{const[a,B]=c.useState([]),[m,A]=c.useState([]),[S,M]=c.useState(!0),[j,y]=c.useState(""),[v,N]=c.useState("all"),[g,_]=c.useState("all"),[P,n]=c.useState(!1),[R,U]=c.useState(!1),[b,h]=c.useState(null),[f,w]=c.useState(!1),[q,E]=c.useState(null),[p,l]=c.useState({type:"",text:""}),[s,r]=c.useState(null),[x,u]=c.useState({patient_name:"",age:25,diagnosis:"",story_content:"",treatment_duration:"",outcome:"",doctor_name:"",content_type:"text",symptoms:[],treatment_methods:[],medications:[],lifestyle_changes:"",rating:5,featured:!1,published:!1,order_index:0,meta_title:"",meta_description:""});c.useEffect(()=>{k()},[]);const k=async()=>{M(!0);try{const[t,o]=await Promise.all([oe(),ne("uz",{active:!0,verified:!0})]);t.data&&B(t.data),o.data&&A(o.data)}catch{l({type:"error",text:"Ma'lumotlarni yuklashda xatolik"})}finally{M(!1)}},L=(t,o)=>{u(i=>({...i,[t]:o})),p.text&&l({type:"",text:""})},$=t=>{const o=t.target.files?.[0];if(o){if(o.size>5*1024*1024){l({type:"error",text:"Rasm hajmi 5MB dan kichik bo'lishi kerak"});return}u(d=>({...d,featured_image:o}));const i=new FileReader;i.onload=()=>r(i.result),i.readAsDataURL(o)}},O=()=>{u(t=>({...t,featured_image:void 0})),r(null)},Q=()=>{u({patient_name:"",age:25,diagnosis:"",story_content:"",treatment_duration:"",outcome:"",doctor_name:"",content_type:"text",symptoms:[],treatment_methods:[],medications:[],lifestyle_changes:"",rating:5,featured:!1,published:!1,order_index:0,meta_title:"",meta_description:""}),h(null),r(null)},Y=()=>{Q(),n(!0)},Z=t=>{const o=(t.translations||[]).reduce((i,d)=>((d.language==="ru"||d.language==="en")&&(i[d.language]={patient_name:d.patient_name||"",diagnosis:d.diagnosis||"",story_content:d.story_content||"",treatment_duration:d.treatment_duration||"",outcome:d.outcome||"",doctor_name:d.doctor_name||"",symptoms:d.symptoms||t.symptoms||[],treatment_methods:d.treatment_methods||t.treatment_methods||[],medications:d.medications||t.medications||[],lifestyle_changes:d.lifestyle_changes||t.lifestyle_changes||"",meta_title:d.meta_title||"",meta_description:d.meta_description||""}),i),{});u({patient_name:t.patient_name,age:t.age,diagnosis:t.diagnosis,story_content:t.story_content,treatment_duration:t.treatment_duration,outcome:t.outcome,doctor_name:t.doctor_name,content_type:t.content_type,youtube_url:t.youtube_url,symptoms:t.symptoms||[],treatment_methods:t.treatment_methods||[],medications:t.medications||[],lifestyle_changes:t.lifestyle_changes||"",rating:t.rating||5,featured:t.featured||!1,published:t.published||!1,order_index:t.order_index||0,meta_title:t.meta_title||"",meta_description:t.meta_description||"",translations:o}),t.featured_image_url&&r(t.featured_image_url),h(t),U(!0)},z=()=>{n(!1),U(!1),Q(),l({type:"",text:""})},K=()=>x.patient_name.trim()?x.diagnosis.trim()?x.story_content.trim()?x.doctor_name.trim()?x.content_type==="video"&&!x.youtube_url?(l({type:"error",text:"Video turi uchun YouTube URL kiritilishi shart"}),!1):!0:(l({type:"error",text:"Shifokor tanlanishi shart"}),!1):(l({type:"error",text:"Hikoya matni kiritilishi shart"}),!1):(l({type:"error",text:"Tashxis kiritilishi shart"}),!1):(l({type:"error",text:"Bemor ismi kiritilishi shart"}),!1),D=async t=>{if(t.preventDefault(),!!K()){w(!0),l({type:"",text:""});try{const o=a.length>0?Math.max(...a.map(W=>typeof W.order_index=="number"?W.order_index:0))+1:1,i={...x,order_index:o},{data:d,error:X}=await ce(i);X?l({type:"error",text:"Xatolik: "+X.message}):(l({type:"success",text:"Bemor tarixi muvaffaqiyatli yaratildi!"}),await k(),setTimeout(()=>{z()},1500))}catch{l({type:"error",text:"Xatolik yuz berdi. Qaytadan urinib ko'ring."})}finally{w(!1)}}},ee=async t=>{if(t.preventDefault(),!(!b||!K())){w(!0),l({type:"",text:""});try{const{data:o,error:i}=await me({id:b.id,...x});i?l({type:"error",text:"Xatolik: "+i.message}):(l({type:"success",text:"Bemor tarixi muvaffaqiyatli yangilandi!"}),await k(),setTimeout(()=>{z()},1500))}catch{l({type:"error",text:"Xatolik yuz berdi. Qaytadan urinib ko'ring."})}finally{w(!1)}}},te=async(t,o)=>{if(confirm(`${o}ning tarixini o'chirishni xohlaysizmi?`)){E(t),l({type:"",text:""});try{const{error:i}=await de(t);i?l({type:"error",text:i.message}):(l({type:"success",text:"Bemor tarixi muvaffaqiyatli o'chirildi!"}),await k())}catch{l({type:"error",text:"Xatolik yuz berdi"})}finally{E(null)}}},V=a.filter(t=>{const o=t.patient_name.toLowerCase().includes(j.toLowerCase())||t.diagnosis.toLowerCase().includes(j.toLowerCase())||t.doctor_name.toLowerCase().includes(j.toLowerCase()),i=v==="all"||t.content_type===v,d=g==="all"||g==="published"&&t.published||g==="draft"&&!t.published||g==="featured"&&t.featured;return o&&i&&d}),se=t=>new Date(t).toLocaleDateString("uz-UZ",{year:"numeric",month:"short",day:"numeric"});return S?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"theme-text-muted",children:"Bemorlar tarixi yuklanmoqda..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold theme-text",children:"Bemorlar Tarixi Boshqaruvi"}),e.jsx("p",{className:"theme-text-secondary",children:"Bemor hikoyalarini yaratish va boshqarish"})]}),e.jsxs("button",{onClick:Y,className:"flex items-center space-x-2 theme-accent-bg text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200",children:[e.jsx(T,{size:20}),e.jsx("span",{children:"Yangi Hikoya"})]})]}),p.text&&e.jsxs("div",{className:`p-4 rounded-xl flex items-center space-x-2 animate-slide-down ${p.type==="success"?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800"}`,children:[p.type==="success"?e.jsx(je,{size:20,className:"text-green-600 dark:text-green-400"}):e.jsx(ye,{size:20,className:"text-red-600 dark:text-red-400"}),e.jsx("span",{className:p.type==="success"?"text-green-700 dark:text-green-300":"text-red-700 dark:text-red-300",children:p.text})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-4",children:[e.jsx("div",{className:"text-2xl font-bold theme-text",children:a.length}),e.jsx("div",{className:"text-sm theme-text-secondary",children:"Jami hikoyalar"})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.filter(t=>t.published).length}),e.jsx("div",{className:"text-sm theme-text-secondary",children:"Nashr etilgan"})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:a.filter(t=>t.featured).length}),e.jsx("div",{className:"text-sm theme-text-secondary",children:"Asosiy"})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:a.filter(t=>t.content_type==="video").length}),e.jsx("div",{className:"text-sm theme-text-secondary",children:"Video"})]}),e.jsxs("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:a.filter(t=>t.content_type==="image").length}),e.jsx("div",{className:"text-sm theme-text-secondary",children:"Rasm"})]})]}),e.jsx("div",{className:"theme-bg rounded-xl theme-shadow theme-border border p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 theme-text-muted",size:20}),e.jsx("input",{type:"text",placeholder:"Bemorlar tarixini qidiring...",value:j,onChange:t=>y(t.target.value),className:"w-full pl-10 pr-4 py-3 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text"})]})}),e.jsx("div",{className:"lg:w-48",children:e.jsxs("select",{value:v,onChange:t=>N(t.target.value),className:"w-full px-4 py-3 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text",children:[e.jsx("option",{value:"all",children:"Barcha turlar"}),e.jsx("option",{value:"text",children:"Matn"}),e.jsx("option",{value:"image",children:"Rasm"}),e.jsx("option",{value:"video",children:"Video"})]})}),e.jsx("div",{className:"lg:w-48",children:e.jsxs("select",{value:g,onChange:t=>_(t.target.value),className:"w-full px-4 py-3 theme-border border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 theme-bg theme-text",children:[e.jsx("option",{value:"all",children:"Barcha holatlar"}),e.jsx("option",{value:"published",children:"Nashr etilgan"}),e.jsx("option",{value:"draft",children:"Qoralama"}),e.jsx("option",{value:"featured",children:"Asosiy"})]})})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:V.map(t=>{const o=xe(t.content_type);return e.jsxs("div",{className:"theme-bg rounded-2xl theme-shadow-lg hover:theme-shadow-xl transition-all duration-300 transform hover:-translate-y-2 theme-border border overflow-hidden group",children:[e.jsxs("div",{className:"relative h-48 overflow-hidden",children:[t.featured_image_url?e.jsx("img",{src:t.featured_image_url,alt:t.patient_name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"}):t.youtube_url?e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:`https://img.youtube.com/vi/${t.youtube_url.split("v=")[1]?.split("&")[0]||"dQw4w9WgXcQ"}/maxresdefault.jpg`,alt:t.patient_name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500",onError:i=>{const d=i.target;d.src=`https://img.youtube.com/vi/${t.youtube_url?.split("v=")[1]?.split("&")[0]||"dQw4w9WgXcQ"}/hqdefault.jpg`}}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center group-hover:bg-opacity-50 transition-all duration-300",children:e.jsx("div",{className:"w-16 h-16 bg-red-600 rounded-full flex items-center justify-center shadow-xl animate-pulse group-hover:scale-110 transition-transform duration-300",children:e.jsx(ve,{size:24,className:"text-white ml-1"})})})]}):e.jsx("div",{className:"w-full h-full theme-bg-tertiary flex items-center justify-center group-hover:theme-bg-quaternary transition-colors duration-300",children:e.jsxs("div",{className:"text-center",children:[e.jsx(o,{size:48,className:"theme-text-muted mx-auto mb-3 group-hover:scale-110 transition-transform duration-300"}),e.jsx("p",{className:"theme-text-muted text-sm font-medium",children:"Matn Hikoyasi"})]})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsxs("div",{className:"absolute top-4 left-4 flex flex-wrap gap-2",children:[e.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full ${ue(t.content_type)}`,children:he(t.content_type)}),e.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full ${t.published?"bg-green-500 text-white":"bg-yellow-500 text-white"}`,children:t.published?"Nashr etilgan":"Qoralama"}),t.featured&&e.jsxs("span",{className:"px-3 py-1 text-xs font-semibold bg-yellow-500 text-white rounded-full flex items-center space-x-1",children:[e.jsx(H,{size:12}),e.jsx("span",{children:"Asosiy"})]})]}),e.jsx("div",{className:"absolute bottom-4 right-4",children:e.jsx("div",{className:"flex items-center space-x-1 bg-white/95 backdrop-blur-sm rounded-full px-3 py-1 shadow-lg",children:[1,2,3,4,5].map(i=>e.jsx(H,{size:12,className:`${i<=(t.rating||5)?"text-yellow-500 fill-current":"text-gray-300"}`},i))})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-xl font-bold theme-text group-hover:theme-accent transition-colors duration-300",children:t.patient_name}),e.jsxs("span",{className:"text-sm theme-text-muted",children:[t.age," yosh"]})]}),e.jsx("p",{className:"text-red-600 dark:text-red-400 font-semibold text-sm mb-3",children:t.diagnosis}),e.jsx("p",{className:"theme-text-secondary text-sm mb-4 line-clamp-3 leading-relaxed",children:t.story_content}),e.jsxs("div",{className:"flex items-center justify-between text-sm theme-text-muted mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ne,{size:14}),e.jsx("span",{className:"truncate max-w-20",children:t.treatment_duration})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(F,{size:14}),e.jsx("span",{className:"truncate max-w-24",children:t.doctor_name})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(_e,{size:14}),e.jsx("span",{children:se(t.created_at)})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs theme-text-muted mb-4 p-3 theme-bg-secondary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{children:[t.symptoms?.length||0," belgi"]}),e.jsxs("span",{children:[t.medications?.length||0," dori"]}),e.jsxs("span",{children:[t.treatment_methods?.length||0," usul"]})]}),e.jsx("span",{className:"text-green-600 dark:text-green-400 font-medium",children:"Muvaffaqiyatli"})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t theme-border",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>Z(t),className:"flex items-center space-x-1 theme-accent hover:text-blue-800 dark:hover:text-blue-300 p-2 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900 transition-all duration-200 transform hover:scale-105",title:"Tahrirlash",children:[e.jsx(we,{size:16}),e.jsx("span",{className:"text-xs font-medium hidden sm:inline",children:"Tahrirlash"})]}),e.jsxs("a",{href:`/patient-stories/${t.id}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 p-2 rounded-lg hover:bg-green-50 dark:hover:bg-green-900 transition-all duration-200 transform hover:scale-105",title:"Ko'rish",children:[e.jsx(ke,{size:16}),e.jsx("span",{className:"text-xs font-medium hidden sm:inline",children:"Ko'rish"})]}),e.jsx("button",{onClick:()=>te(t.id,t.patient_name),disabled:q===t.id,className:"flex items-center space-x-1 text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900 transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:transform-none",title:"O'chirish",children:q===t.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}):e.jsxs(e.Fragment,{children:[e.jsx(ze,{size:16}),e.jsx("span",{className:"text-xs font-medium hidden sm:inline",children:"O'chirish"})]})})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs theme-text-muted",children:[e.jsx(Ce,{size:12}),e.jsxs("span",{children:[t.rating,"/5"]})]})]})]})]},t.id)})}),V.length===0&&!S&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"theme-text-muted mb-4",children:e.jsx(G,{size:48,className:"mx-auto"})}),e.jsx("h3",{className:"text-xl font-semibold theme-text-secondary mb-2",children:"Bemor tarixi topilmadi"}),e.jsx("p",{className:"theme-text-muted mb-6",children:"Qidiruv so'zini o'zgartiring yoki yangi hikoya yarating"}),e.jsxs("button",{onClick:Y,className:"inline-flex items-center space-x-2 theme-accent-bg text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors duration-200",children:[e.jsx(T,{size:20}),e.jsx("span",{children:"Birinchi hikoyani yaratish"})]})]}),P&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"theme-bg rounded-2xl theme-shadow-lg theme-border border p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold theme-text",children:"Yangi Bemor Tarixi"}),e.jsx("button",{onClick:z,className:"theme-text-secondary hover:theme-text p-1 rounded-lg hover:theme-bg-tertiary transition-colors duration-200",children:e.jsx(C,{size:20})})]}),e.jsxs("form",{onSubmit:D,children:[e.jsx(J,{formData:x,doctors:m,onInputChange:L,onFormDataChange:u,imagePreview:s,onImageUpload:$,onRemoveImage:O}),e.jsxs("div",{className:"flex space-x-3 pt-6 mt-6 border-t theme-border",children:[e.jsx("button",{type:"button",onClick:z,className:"flex-1 theme-border border theme-text-secondary px-4 py-3 rounded-lg hover:theme-bg-tertiary transition-colors duration-200",children:"Bekor qilish"}),e.jsxs("button",{type:"submit",disabled:f,className:"flex-1 bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 transition-colors duration-200 disabled:opacity-50 flex items-center justify-center space-x-2",children:[e.jsx(I,{size:18}),e.jsx("span",{children:f?"Yaratilmoqda...":"Yaratish"})]})]})]})]})}),R&&b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"theme-bg rounded-2xl theme-shadow-lg theme-border border p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold theme-text",children:"Bemor Tarixini Tahrirlash"}),e.jsx("button",{onClick:z,className:"theme-text-secondary hover:theme-text p-1 rounded-lg hover:theme-bg-tertiary transition-colors duration-200",children:e.jsx(C,{size:20})})]}),e.jsxs("form",{onSubmit:ee,children:[e.jsx(J,{formData:x,doctors:m,onInputChange:L,onFormDataChange:u,imagePreview:s,onImageUpload:$,onRemoveImage:O}),e.jsxs("div",{className:"flex space-x-3 pt-6 mt-6 border-t theme-border",children:[e.jsx("button",{type:"button",onClick:z,className:"flex-1 theme-border border theme-text-secondary px-4 py-3 rounded-lg hover:theme-bg-tertiary transition-colors duration-200",children:"Bekor qilish"}),e.jsxs("button",{type:"submit",disabled:f,className:"flex-1 bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 transition-colors duration-200 disabled:opacity-50 flex items-center justify-center space-x-2",children:[e.jsx(I,{size:18}),e.jsx("span",{children:f?"Saqlanmoqda...":"Saqlash"})]})]})]})]})})]})};export{We as default};
