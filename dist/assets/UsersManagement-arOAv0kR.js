import{l as P,s as w,c as S,j as e,f as E,G as M,r as c,S as q,U as X,a as G}from"./index-DO34fR0A.js";import{g as F,a as Z,d as K}from"./adminUsers-BGpPnm0u.js";import{S as T}from"./search-Ck5ZdOCr.js";import{C as z}from"./check-circle-DItbFGDG.js";import{A}from"./alert-circle-CDWwFaqK.js";import{C as D}from"./clock-mDGFTiaF.js";import{S as Q}from"./square-pen-NYggparf.js";import{E as V}from"./eye-BSzZDvbN.js";import{T as O}from"./trash-2-Dgq6CDrx.js";import{M as I}from"./mail-DRxa8nca.js";import{U as J}from"./user-check-QQX85xyk.js";import{P as R}from"./phone-4DozbPMs.js";import{C as W}from"./calendar-BFr5uWGV.js";import{M as $}from"./message-square-DDKqcEs4.js";import{X as B}from"./x-circle-dfQH5DX3.js";import{T as Y}from"./trending-up-O1vFHddg.js";import{F as ee}from"./filter-DP8NGhQy.js";const H=async s=>{try{if(console.log("ðŸ“‹ Loading consultation requests from Supabase..."),!P()||!w)return console.log("âš ï¸ Supabase not available, using mock data"),{data:U(),error:null};let l=w.from("consultation_requests").select("*").order("created_at",{ascending:!1});s?.status&&s.status,s?.limit;const{data:n,error:r}=await l;return r?(console.log("âŒ Supabase error loading consultation requests:",r),console.log("ðŸ”„ Falling back to mock data"),{data:U(),error:null}):(console.log("âœ… Consultation requests loaded from Supabase:",n?.length||0),{data:n,error:null})}catch(l){return console.warn("ðŸ“‹ Error fetching consultation requests from Supabase, using mock data:",l),{data:U(),error:null}}},te=async s=>{try{if(!P()||!w)return{data:null,error:{message:"Supabase not available"}};const{id:l,...n}=s,{data:r,error:u}=await w.from("consultation_requests").update(n).eq("id",l).select().single();return{data:r,error:u}}catch(l){return{data:null,error:l}}},ae=async s=>{try{if(!P()||!w)return{error:{message:"Supabase not available"}};const{error:l}=await w.from("consultation_requests").delete().eq("id",s);return{error:l}}catch(l){return{error:l}}},U=()=>[{id:"1",first_name:"Malika",last_name:"Karimova",age:45,disease_type:"Revmatoid artrit",phone:"+998901234567",comments:"Qo'llarimda og'riq va shishish bor. Ertalab qotishlik kuchli.",status:"pending",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"2",first_name:"Akmal",last_name:"Toshmatov",age:52,disease_type:"Osteoartroz",phone:"+998901234568",comments:"Tizza og'riqlari, ayniqsa yurish paytida kuchayadi.",status:"contacted",created_at:new Date(Date.now()-864e5).toISOString(),updated_at:new Date(Date.now()-864e5).toISOString()},{id:"3",first_name:"Nodira",last_name:"Abdullayeva",age:38,disease_type:"Fibromyalgiya",phone:"+998901234569",comments:"Butun vujudda og'riq, charchoq va uyqu buzilishi.",status:"completed",created_at:new Date(Date.now()-1728e5).toISOString(),updated_at:new Date(Date.now()-1728e5).toISOString()}],re=({searchTerm:s,selectedRole:l,selectedProvider:n,onSearchChange:r,onRoleChange:u,onProviderChange:b,userCounts:m})=>{const{t:x}=S(),f=[{value:"all",label:x("allRoles"),count:m.total},{value:"admin",label:x("adminRole"),count:m.byRole.admin||0},{value:"moderator",label:x("moderatorRole"),count:m.byRole.moderator||0},{value:"doctor",label:x("doctorRole"),count:m.byRole.doctor||0},{value:"patient",label:x("patientRole"),count:m.byRole.patient||0}],g=[{value:"all",label:x("allProviders"),count:m.total},{value:"email",label:x("emailProvider"),count:m.byProvider.email||0},{value:"google",label:x("googleProvider"),count:m.byProvider.google||0}];return e.jsx("div",{className:"theme-bg rounded-lg theme-shadow theme-border border p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 theme-text-muted",size:20}),e.jsx("input",{type:"text",placeholder:x("searchUsers"),value:s,onChange:i=>r(i.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 theme-text"})]})}),e.jsx("div",{className:"lg:w-56",children:e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 theme-text-muted",size:20}),e.jsx("select",{value:l,onChange:i=>u(i.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 appearance-none theme-text",children:f.map(i=>e.jsxs("option",{value:i.value,children:[i.label," (",i.count,")"]},i.value))})]})}),e.jsx("div",{className:"lg:w-48",children:e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 theme-text-muted",size:20}),e.jsx("select",{value:n,onChange:i=>b(i.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 appearance-none theme-text",children:g.map(i=>e.jsxs("option",{value:i.value,children:[i.label," (",i.count,")"]},i.value))})]})})]})})},se=({searchTerm:s,selectedRole:l,selectedProvider:n})=>{const{t:r}=S(),[u,b]=c.useState([]),[m,x]=c.useState([]),[f,g]=c.useState(!0),[i,h]=c.useState(null),[d,p]=c.useState({type:"",text:""});c.useEffect(()=>{v()},[]);const v=async()=>{g(!0);try{const[t,a]=await Promise.all([F(),Z()]);t.data&&b(t.data),a.data&&x(a.data)}catch(t){console.error("Error loading users:",t),p({type:"error",text:r("errorLoadingUsers")})}finally{g(!1)}},N=async(t,a)=>{if(confirm(`${a} ${r("confirmDeleteUser")}`)){h(t),p({type:"",text:""});try{const{error:o}=await K(t);o?p({type:"error",text:o.message}):(p({type:"success",text:r("userDeleted")}),await v())}catch{p({type:"error",text:r("error")})}finally{h(null)}}},y=u.map(t=>{const a=m.find(o=>o.id===t.id);return{...t,profile:a,full_name:a?.full_name||t.user_metadata?.full_name||t.user_metadata?.name||t.email?.split("@")[0]||"User",role:a?.role||t.user_metadata?.role||"patient",phone:a?.phone||t.user_metadata?.phone||t.phone,avatar_url:a?.avatar_url||t.user_metadata?.avatar_url||t.user_metadata?.picture}}).filter(t=>{const a=t.full_name.toLowerCase().includes(s.toLowerCase())||t.email.toLowerCase().includes(s.toLowerCase()),o=l==="all"||t.role===l,j=n==="all"||t.app_metadata?.provider===n;return a&&o&&j}),C=t=>{switch(t){case"admin":return"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200";case"moderator":return"bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200";case"doctor":return"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200";case"patient":return"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200";default:return"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"}},_=t=>{switch(t){case"google":return e.jsx("div",{className:"w-4 h-4 bg-white rounded-full flex items-center justify-center shadow-sm",children:e.jsxs("svg",{className:"w-3 h-3",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})});case"email":return e.jsx(I,{size:16,className:"text-blue-600"});default:return e.jsx(q,{size:16,className:"text-gray-600"})}},L=t=>new Date(t).toLocaleDateString("uz-UZ",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return f?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"theme-text-muted",children:r("usersLoading")})]})}):e.jsxs("div",{className:"space-y-6",children:[d.text&&e.jsxs("div",{className:`p-4 rounded-xl flex items-center space-x-2 animate-slide-down ${d.type==="success"?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800"}`,children:[d.type==="success"?e.jsx(z,{size:20,className:"text-green-600 dark:text-green-400"}):e.jsx(A,{size:20,className:"text-red-600 dark:text-red-400"}),e.jsx("span",{className:d.type==="success"?"text-green-700 dark:text-green-300":"text-red-700 dark:text-red-300",children:d.text})]}),e.jsx("div",{className:"theme-bg rounded-lg theme-shadow theme-border border overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y theme-border",children:[e.jsx("thead",{className:"theme-bg-secondary",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium theme-text-muted uppercase tracking-wider",children:r("userTable")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium theme-text-muted uppercase tracking-wider",children:r("role")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium theme-text-muted uppercase tracking-wider",children:r("provider")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium theme-text-muted uppercase tracking-wider",children:r("phone")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium theme-text-muted uppercase tracking-wider",children:r("lastLogin")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium theme-text-muted uppercase tracking-wider",children:r("statusTable")}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium theme-text-muted uppercase tracking-wider",children:r("actionsTable")})]})}),e.jsx("tbody",{className:"theme-bg divide-y theme-border",children:y.map(t=>e.jsxs("tr",{className:"hover:theme-bg-tertiary transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[t.avatar_url?e.jsx("img",{src:t.avatar_url,alt:t.full_name,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"theme-accent font-medium text-sm",children:t.full_name.charAt(0)})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium theme-text",children:t.full_name}),e.jsx("div",{className:"text-sm theme-text-muted",children:t.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full capitalize ${C(t.role)}`,children:t.role})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[_(t.app_metadata?.provider||"email"),e.jsx("span",{className:"text-sm theme-text capitalize",children:t.app_metadata?.provider||"email"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm theme-text",children:t.phone||r("notEntered")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm theme-text-muted",children:t.last_sign_in_at?e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(D,{size:14}),e.jsx("span",{children:L(t.last_sign_in_at)})]}):r("never")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${t.email_confirmed_at?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200"}`,children:t.email_confirmed_at?r("confirmedStatus"):r("unconfirmedStatus")})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("button",{className:"theme-accent hover:text-blue-900 dark:hover:text-blue-300 p-1 rounded",children:e.jsx(Q,{size:16})}),e.jsx("button",{className:"text-green-600 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300 p-1 rounded",children:e.jsx(V,{size:16})}),e.jsx("button",{onClick:()=>N(t.id,t.full_name),disabled:i===t.id,className:"text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300 p-1 rounded disabled:opacity-50",children:i===t.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}):e.jsx(O,{size:16})})]})})]},t.id))})]})})}),y.length===0&&!f&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"theme-text-muted mb-4",children:e.jsx(T,{size:48,className:"mx-auto"})}),e.jsx("h3",{className:"text-xl font-semibold theme-text-secondary mb-2",children:r("userNotFound")}),e.jsx("p",{className:"theme-text-muted",children:r("changeSearchOrFilters")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm theme-text-secondary",children:[y.length," ",r("usersShown")]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"px-4 py-2 theme-border border rounded-lg hover:theme-bg-tertiary transition-colors duration-200 theme-text-secondary",children:r("previous")}),e.jsx("button",{className:"px-4 py-2 theme-accent-bg text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"1"}),e.jsx("button",{className:"px-4 py-2 theme-border border rounded-lg hover:theme-bg-tertiary transition-colors duration-200 theme-text-secondary",children:r("next")})]})]})]})},le=({stats:s})=>{const{t:l}=S(),n=[{name:l("totalUsersStats"),value:s.total.toLocaleString(),icon:E,color:"from-primary-500 to-primary-600",bgColor:"bg-primary-100 dark:bg-primary-900/20",textColor:"text-primary-600 dark:text-primary-400"},{name:l("confirmed"),value:s.confirmed.toLocaleString(),icon:J,color:"from-primary-500 to-primary-600",bgColor:"bg-primary-100 dark:bg-primary-900/20",textColor:"text-primary-600 dark:text-primary-400"},{name:l("emailUsers"),value:s.emailUsers.toLocaleString(),icon:I,color:"from-primary-500 to-primary-600",bgColor:"bg-primary-100 dark:bg-primary-900/20",textColor:"text-primary-600 dark:text-primary-400"},{name:l("googleUsers"),value:s.googleUsers.toLocaleString(),icon:M,color:"from-primary-500 to-primary-600",bgColor:"bg-primary-100 dark:bg-primary-900/20",textColor:"text-primary-600 dark:text-primary-400"},{name:l("last7Days"),value:s.recentSignups.toLocaleString(),icon:D,color:"from-primary-500 to-primary-600",bgColor:"bg-primary-100 dark:bg-primary-900/20",textColor:"text-primary-600 dark:text-primary-400"},{name:l("unconfirmed"),value:s.unconfirmed.toLocaleString(),icon:q,color:"from-primary-500 to-primary-600",bgColor:"bg-primary-100 dark:bg-primary-900/20",textColor:"text-primary-600 dark:text-primary-400"}];return e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:n.map(r=>{const u=r.icon;return e.jsxs("div",{className:"theme-bg rounded-lg theme-shadow theme-border border p-4 hover:theme-shadow-lg transition-all duration-300 transform hover:-translate-y-1",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("div",{className:`p-2 rounded-lg ${r.bgColor}`,children:e.jsx(u,{size:20,className:r.textColor})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold theme-text mb-1",children:r.value}),e.jsx("p",{className:"text-xs theme-text-secondary",children:r.name})]})]},r.name)})})},ne=({searchTerm:s,selectedStatus:l})=>{const{t:n}=S(),[r,u]=c.useState([]),[b,m]=c.useState(!0),[x,f]=c.useState(null),[g,i]=c.useState(null),[h,d]=c.useState({type:"",text:""});c.useEffect(()=>{p()},[]);const p=async()=>{m(!0);try{const{data:t}=await H();t&&u(t)}catch(t){console.error("Error loading consultation requests:",t),d({type:"error",text:n("errorLoadingConsultationRequests")})}finally{m(!1)}},v=async(t,a)=>{f(t),d({type:"",text:""});try{const{error:o}=await te({id:t,status:a});o?d({type:"error",text:o.message}):(d({type:"success",text:n("statusUpdated")}),await p())}catch{d({type:"error",text:"Xatolik yuz berdi"})}finally{f(null)}},N=async(t,a)=>{if(confirm(`${a}${n("confirmDeleteRequest")}`)){i(t),d({type:"",text:""});try{const{error:o}=await ae(t);o?d({type:"error",text:o.message}):(d({type:"success",text:n("requestDeleted")}),await p())}catch{d({type:"error",text:n("error")})}finally{i(null)}}},k=r.filter(t=>{const a=t.first_name.toLowerCase().includes(s.toLowerCase())||t.last_name.toLowerCase().includes(s.toLowerCase())||t.disease_type.toLowerCase().includes(s.toLowerCase())||t.phone.includes(s),o=l==="all"||t.status===l;return a&&o}),y=t=>{switch(t){case"pending":return"bg-yellow-100 text-yellow-800";case"contacted":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},C=t=>{switch(t){case"pending":return D;case"contacted":return R;case"completed":return z;case"cancelled":return B;default:return A}},_=t=>{switch(t){case"pending":return n("pending");case"contacted":return n("contacted");case"completed":return n("completed");case"cancelled":return n("cancelled");default:return n("unknown")}},L=t=>new Date(t).toLocaleDateString("uz-UZ",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return b?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("p",{className:"theme-text-muted",children:n("consultationRequestsLoading")})]})}):e.jsxs("div",{className:"space-y-6",children:[h.text&&e.jsxs("div",{className:`p-4 rounded-xl flex items-center space-x-2 animate-slide-down ${h.type==="success"?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[h.type==="success"?e.jsx(z,{size:20,className:"text-green-600"}):e.jsx(A,{size:20,className:"text-red-600"}),e.jsx("span",{className:h.type==="success"?"text-green-700":"text-red-700",children:h.text})]}),e.jsx("div",{className:"theme-bg rounded-lg theme-shadow theme-border border overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y theme-border",children:[e.jsx("thead",{className:"theme-bg-secondary",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium theme-text-muted uppercase tracking-wider",children:n("patientTable")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium theme-text-muted uppercase tracking-wider",children:n("disease")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium theme-text-muted uppercase tracking-wider",children:n("phone")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium theme-text-muted uppercase tracking-wider",children:n("statusTable")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium theme-text-muted uppercase tracking-wider",children:n("askedTime")}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium theme-text-muted uppercase tracking-wider",children:n("actionsTable")})]})}),e.jsx("tbody",{className:"theme-bg divide-y theme-border",children:k.map(t=>{const a=C(t.status);return e.jsxs("tr",{className:"hover:theme-bg-tertiary transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx(X,{size:16,className:"theme-accent"})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{className:"text-sm font-medium theme-text",children:[t.first_name," ",t.last_name]}),e.jsxs("div",{className:"text-sm theme-text-muted",children:[t.age," ",n("yearsOld")]})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm theme-text",children:t.disease_type}),t.comments&&e.jsx("div",{className:"text-xs theme-text-muted line-clamp-2 max-w-48",children:t.comments})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{size:14,className:"theme-text-muted"}),e.jsx("a",{href:`tel:${t.phone}`,className:"text-sm theme-accent hover:text-primary-700 transition-colors duration-200",children:t.phone})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(a,{size:16,className:t.status==="pending"?"text-yellow-600":t.status==="contacted"?"text-blue-600":t.status==="completed"?"text-green-600":"text-red-600"}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${y(t.status)}`,children:_(t.status)})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm theme-text-muted",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(W,{size:14}),e.jsx("span",{children:L(t.created_at)})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsxs("select",{value:t.status,onChange:o=>v(t.id,o.target.value),disabled:x===t.id,className:"text-xs px-2 py-1 theme-border border rounded theme-bg theme-text disabled:opacity-50",children:[e.jsx("option",{value:"pending",children:n("pending")}),e.jsx("option",{value:"contacted",children:n("contacted")}),e.jsx("option",{value:"completed",children:n("completed")}),e.jsx("option",{value:"cancelled",children:n("cancelled")})]}),e.jsx("a",{href:`tel:${t.phone}`,className:"text-green-600 hover:text-green-900 p-1 rounded",title:n("call"),children:e.jsx(R,{size:16})}),e.jsx("button",{onClick:()=>N(t.id,`${t.first_name} ${t.last_name}`),disabled:g===t.id,className:"text-red-600 hover:text-red-900 p-1 rounded disabled:opacity-50",title:n("deleteAction"),children:g===t.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}):e.jsx(O,{size:16})})]})})]},t.id)})})]})})}),k.length===0&&!b&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"theme-text-muted mb-4",children:e.jsx($,{size:48,className:"mx-auto"})}),e.jsx("h3",{className:"text-xl font-semibold theme-text-secondary mb-2",children:n("consultationRequestNotFound")}),e.jsx("p",{className:"theme-text-muted",children:n("changeSearchOrFilters")})]})]})},oe=({stats:s})=>{const{t:l}=S(),n=[{name:l("totalRequests"),value:s.total.toLocaleString(),icon:$,color:"from-primary-500 to-primary-600",bgColor:"bg-primary-100 dark:bg-primary-900/20",textColor:"text-primary-600 dark:text-primary-400"},{name:l("pending"),value:s.pending.toLocaleString(),icon:D,color:"from-primary-500 to-primary-600",bgColor:"bg-primary-100 dark:bg-primary-900/20",textColor:"text-primary-600 dark:text-primary-400"},{name:l("contacted"),value:s.contacted.toLocaleString(),icon:R,color:"from-primary-500 to-primary-600",bgColor:"bg-primary-100 dark:bg-primary-900/20",textColor:"text-primary-600 dark:text-primary-400"},{name:l("completed"),value:s.completed.toLocaleString(),icon:z,color:"from-primary-500 to-primary-600",bgColor:"bg-primary-100 dark:bg-primary-900/20",textColor:"text-primary-600 dark:text-primary-400"},{name:l("cancelled"),value:s.cancelled.toLocaleString(),icon:B,color:"from-primary-500 to-primary-600",bgColor:"bg-primary-100 dark:bg-primary-900/20",textColor:"text-primary-600 dark:text-primary-400"},{name:l("recentRequests"),value:s.recent.toLocaleString(),icon:Y,color:"from-primary-500 to-primary-600",bgColor:"bg-primary-100 dark:bg-primary-900/20",textColor:"text-primary-600 dark:text-primary-400"}];return e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:n.map(r=>{const u=r.icon;return e.jsxs("div",{className:"theme-bg rounded-lg theme-shadow theme-border border p-4 hover:theme-shadow-lg transition-all duration-300 transform hover:-translate-y-1",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("div",{className:`p-2 rounded-lg ${r.bgColor}`,children:e.jsx(u,{size:20,className:r.textColor})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold theme-text mb-1",children:r.value}),e.jsx("p",{className:"text-xs theme-text-secondary",children:r.name})]})]},r.name)})})},ke=()=>{const{t:s}=S();G();const[l,n]=c.useState([]),[r,u]=c.useState([]),[b,m]=c.useState(!0),[x,f]=c.useState(""),[g,i]=c.useState("all"),[h,d]=c.useState("all"),[p,v]=c.useState(""),[N,k]=c.useState("all");c.useEffect(()=>{y()},[]);const y=async()=>{m(!0);try{const[a,o]=await Promise.all([F(),H()]);a.data&&n(a.data),o.data&&u(o.data)}catch(a){console.error("Error loading data:",a)}finally{m(!1)}},C={total:l.length,confirmed:l.filter(a=>a.email_confirmed_at).length,unconfirmed:l.filter(a=>!a.email_confirmed_at).length,emailUsers:l.filter(a=>a.app_metadata?.provider==="email").length,googleUsers:l.filter(a=>a.app_metadata?.provider==="google").length,recentSignups:l.filter(a=>{const o=new Date;return o.setDate(o.getDate()-7),new Date(a.created_at)>o}).length},_={total:r.length,pending:r.filter(a=>a.status==="pending").length,contacted:r.filter(a=>a.status==="contacted").length,completed:r.filter(a=>a.status==="completed").length,cancelled:r.filter(a=>a.status==="cancelled").length,recent:r.filter(a=>{const o=new Date;return o.setDate(o.getDate()-7),new Date(a.created_at)>o}).length},L={total:l.length,byRole:l.reduce((a,o)=>{const j=o.user_metadata?.role||"patient";return a[j]=(a[j]||0)+1,a},{}),byProvider:l.reduce((a,o)=>{const j=o.app_metadata?.provider||"email";return a[j]=(a[j]||0)+1,a},{})},t={total:r.length,pending:r.filter(a=>a.status==="pending").length,contacted:r.filter(a=>a.status==="contacted").length,completed:r.filter(a=>a.status==="completed").length,cancelled:r.filter(a=>a.status==="cancelled").length};return b?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"theme-text-muted",children:s("usersLoading")})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold theme-text",children:s("usersManagement")}),e.jsx("p",{className:"theme-text-secondary",children:s("manageUsersDesc")})]})}),e.jsx(le,{stats:C}),e.jsx(re,{searchTerm:x,selectedRole:g,selectedProvider:h,onSearchChange:f,onRoleChange:i,onProviderChange:d,userCounts:L}),e.jsx(se,{searchTerm:x,selectedRole:g,selectedProvider:h}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold theme-text flex items-center space-x-2",children:[e.jsx($,{size:20,className:"text-primary-600"}),e.jsx("span",{children:s("freeConsultationRequests")})]}),e.jsx("p",{className:"theme-text-secondary text-sm",children:s("consultationRequestsDesc")})]})}),e.jsx(oe,{stats:_}),e.jsx("div",{className:"theme-bg rounded-lg theme-shadow theme-border border p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 theme-text-muted",size:20}),e.jsx("input",{type:"text",placeholder:s("searchConsultationRequests"),value:p,onChange:a=>v(a.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 theme-text"})]})}),e.jsx("div",{className:"lg:w-48",children:e.jsxs("div",{className:"relative",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 theme-text-muted",size:20}),e.jsxs("select",{value:N,onChange:a=>k(a.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 appearance-none theme-text",children:[e.jsxs("option",{value:"all",children:[s("allStatuses")," (",t.total,")"]}),e.jsxs("option",{value:"pending",children:[s("pending")," (",t.pending,")"]}),e.jsxs("option",{value:"contacted",children:[s("contacted")," (",t.contacted,")"]}),e.jsxs("option",{value:"completed",children:[s("completed")," (",t.completed,")"]}),e.jsxs("option",{value:"cancelled",children:[s("cancelled")," (",t.cancelled,")"]})]})]})})]})}),e.jsx(ne,{searchTerm:p,selectedStatus:N})]})]})};export{ke as default};
