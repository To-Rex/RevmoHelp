import{d as y,r as a}from"./index-DtX8_sFx.js";import{a as h,b as N,m as p}from"./notifications-BHHT7tvd.js";const U=()=>{const{user:n,loading:i}=y(),[l,c]=a.useState([]),[m,u]=a.useState(0),[g,d]=a.useState(!0);a.useEffect(()=>{if(i||!n){d(!1);return}f(),o();const r=setInterval(()=>{o()},3e4);return()=>clearInterval(r)},[n,i]);const f=async()=>{try{const{data:r}=await h();r&&c(r)}catch(r){console.error("Error loading notifications:",r)}finally{d(!1)}},o=async()=>{try{const{count:r}=await N();u(r)}catch(r){console.error("Error loading unread count:",r)}};return{notifications:l,unreadCount:m,loading:g,markAsRead:async r=>{try{const{error:e}=await p(r);e||(c(s=>s.map(t=>t.id===r?{...t,read_by:[...t.read_by,"current-user"]}:t)),u(s=>Math.max(0,s-1)))}catch(e){console.error("Error marking notification as read:",e)}},refreshNotifications:()=>{f(),o()}}};export{U as u};
