import{l,s as n}from"./index-BboKWWFL.js";const _=async(t,r)=>{try{if(!l()||!n)return console.log("‚ö†Ô∏è Supabase not available for image upload"),URL.createObjectURL(t);console.log("üì∏ Uploading story image:",t.name,"for story:",r);const i=t.name.split(".").pop(),e=`patient-stories/${`${r}-${Date.now()}.${i}`}`,{data:d,error:o}=await n.storage.from("post-images").upload(e,t,{cacheControl:"3600",upsert:!1});if(o)return console.error("‚ùå Story image upload error:",o),console.log("üîÑ Using fallback URL"),URL.createObjectURL(t);console.log("‚úÖ Story image uploaded successfully:",d.path);const{data:{publicUrl:a}}=n.storage.from("post-images").getPublicUrl(e);return console.log("üîó Story image public URL:",a),a}catch(i){return console.error("‚ùå Story image upload error:",i),console.log("üîÑ Using fallback URL"),URL.createObjectURL(t)}},p=async t=>{try{if(!l()||!n)return!0;if(!l()||!n)return!1;const r=t.split("/"),m=`patient-stories/${r[r.length-1]}`,{error:e}=await n.storage.from("post-images").remove([m]);return e?(console.error("Image delete error:",e),!1):!0}catch(r){return console.error("Delete error:",r),!1}},y=async(t="uz",r)=>{try{if(console.log("üìñ Loading patient stories from Supabase for language:",t),!l()||!n)return console.log("‚ö†Ô∏è Supabase not available, using mock data"),{data:c(t),error:null};let i=n.from("patient_stories").select(`
        *,
        translations:patient_story_translations(*)
      `).order("order_index",{ascending:!0});r?.published!==void 0&&(i=i.eq("published",r.published)),r?.featured!==void 0&&(i=i.eq("featured",r.featured)),r?.limit&&(i=i.limit(r.limit));const{data:m,error:e}=await i;if(e)return console.log("‚ùå Supabase error loading patient stories:",e),console.log("üîÑ Falling back to mock data"),{data:c(t),error:null};const d=m?.map(o=>{const a=o.translations?.find(s=>s.language===t);if(a){const s=Array.isArray(a.symptoms)&&a.symptoms.length>0?a.symptoms:o.symptoms,u=Array.isArray(a.treatment_methods)&&a.treatment_methods.length>0?a.treatment_methods:o.treatment_methods,h=Array.isArray(a.medications)&&a.medications.length>0?a.medications:o.medications;return{...o,patient_name:a.patient_name,diagnosis:a.diagnosis,story_content:a.story_content,treatment_duration:a.treatment_duration,outcome:a.outcome,doctor_name:a.doctor_name,symptoms:s,treatment_methods:u,medications:h,lifestyle_changes:a.lifestyle_changes||o.lifestyle_changes,meta_title:a.meta_title||o.meta_title,meta_description:a.meta_description||o.meta_description,current_language:t}}return o})||[];return console.log("‚úÖ Patient stories loaded from Supabase:",d.length),{data:d,error:null}}catch(i){return console.warn("üìñ Error fetching patient stories from Supabase, using mock data:",i),{data:c(t),error:null}}},g=async(t,r="uz")=>{try{if(!l()||!n){const a=c(r).find(s=>s.id===t);return{data:a||null,error:a?null:{message:"Story not found"}}}const{data:i,error:m}=await n.from("patient_stories").select(`
        *,
        translations:patient_story_translations(*)
      `).eq("id",t).single();if(m)return console.log("‚ùå Supabase error loading patient story:",m),{data:c(r).find(s=>s.id===t)||null,error:null};const e=i.translations?.find(o=>o.language===r);return{data:e?{...i,patient_name:e.patient_name,diagnosis:e.diagnosis,story_content:e.story_content,treatment_duration:e.treatment_duration,outcome:e.outcome,doctor_name:e.doctor_name,symptoms:Array.isArray(e.symptoms)&&e.symptoms.length>0?e.symptoms:i.symptoms,treatment_methods:Array.isArray(e.treatment_methods)&&e.treatment_methods.length>0?e.treatment_methods:i.treatment_methods,medications:Array.isArray(e.medications)&&e.medications.length>0?e.medications:i.medications,lifestyle_changes:e.lifestyle_changes||i.lifestyle_changes,meta_title:e.meta_title||i.meta_title,meta_description:e.meta_description||i.meta_description,current_language:r}:i,error:null}}catch(i){return console.warn("üìñ Error fetching patient story from Supabase:",i),{data:null,error:i}}},b=async t=>{try{if(!l()||!n)return{data:{id:Date.now().toString(),...t,featured_image_url:t.featured_image?URL.createObjectURL(t.featured_image):void 0,published:t.published??!1,order_index:t.order_index??0,featured:t.featured??!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},error:null};const{data:r,error:i}=await n.from("patient_stories").insert({patient_name:t.patient_name,age:t.age,diagnosis:t.diagnosis,story_content:t.story_content,treatment_duration:t.treatment_duration,outcome:t.outcome,doctor_name:t.doctor_name,content_type:t.content_type,youtube_url:t.youtube_url,symptoms:t.symptoms,treatment_methods:t.treatment_methods,medications:t.medications,lifestyle_changes:t.lifestyle_changes,rating:t.rating,featured:t.featured??!1,published:t.published??!1,order_index:t.order_index??0,meta_title:t.meta_title,meta_description:t.meta_description}).select().single();if(i)return{data:null,error:i};if(t.featured_image&&r){const e=await _(t.featured_image,r.id);if(e){const{data:d,error:o}=await n.from("patient_stories").update({featured_image_url:e}).eq("id",r.id).select().single();if(o)return{data:null,error:o};Object.assign(r,d)}}const{error:m}=await n.from("patient_story_translations").insert({story_id:r.id,language:"uz",patient_name:t.patient_name,diagnosis:t.diagnosis,story_content:t.story_content,treatment_duration:t.treatment_duration,outcome:t.outcome,doctor_name:t.doctor_name,symptoms:t.symptoms,treatment_methods:t.treatment_methods,medications:t.medications,lifestyle_changes:t.lifestyle_changes,meta_title:t.meta_title,meta_description:t.meta_description});if(m&&console.warn("Warning: Could not create default translation:",m),t.translations){const e=Object.entries(t.translations).map(([o,a])=>({story_id:r.id,language:o,patient_name:a.patient_name??t.patient_name,diagnosis:a.diagnosis??t.diagnosis,story_content:a.story_content??t.story_content,treatment_duration:a.treatment_duration??t.treatment_duration,outcome:a.outcome??t.outcome,doctor_name:a.doctor_name??t.doctor_name,symptoms:a.symptoms??t.symptoms,treatment_methods:a.treatment_methods??t.treatment_methods,medications:a.medications??t.medications,lifestyle_changes:a.lifestyle_changes??t.lifestyle_changes,meta_title:a.meta_title??t.meta_title,meta_description:a.meta_description??t.meta_description})),{error:d}=await n.from("patient_story_translations").insert(e);d&&console.warn("Warning: Could not create additional translations:",d)}return{data:r,error:null}}catch(r){return{data:null,error:r}}},k=async t=>{try{if(!l()||!n)return{data:null,error:{message:"Supabase not available"}};const{id:r,featured_image:i,translations:m,...e}=t;if(i){const a=await _(i,r);a&&(e.featured_image_url=a)}const{data:d,error:o}=await n.from("patient_stories").update(e).eq("id",r).select().single();if(o)return{data:null,error:o};if(m)for(const[a,s]of Object.entries(m)){const{error:u}=await n.from("patient_story_translations").upsert({story_id:r,language:a,patient_name:s.patient_name??e.patient_name,diagnosis:s.diagnosis??e.diagnosis,story_content:s.story_content??e.story_content,treatment_duration:s.treatment_duration??e.treatment_duration,outcome:s.outcome??e.outcome,doctor_name:s.doctor_name??e.doctor_name,symptoms:s.symptoms??e.symptoms,treatment_methods:s.treatment_methods??e.treatment_methods,medications:s.medications??e.medications,meta_title:s.meta_title??e.meta_title,meta_description:s.meta_description??e.meta_description});u&&console.warn(`Warning: Could not update ${a} translation:`,u)}return{data:d,error:null}}catch(r){return{data:null,error:r}}},v=async t=>{try{if(!l()||!n)return{error:{message:"Supabase not available"}};const{data:r}=await n.from("patient_stories").select("featured_image_url").eq("id",t).single();r?.featured_image_url&&await p(r.featured_image_url);const{error:i}=await n.from("patient_stories").delete().eq("id",t);return{error:i}}catch(r){return{error:r}}},c=t=>[{id:"550e8400-e29b-41d4-a716-446655440001",patient_name:t==="ru"?"–ú–∞–ª–∏–∫–∞ –ö–∞—Ä–∏–º–æ–≤–∞":"Malika Karimova",age:45,diagnosis:t==="ru"?"–†–µ–≤–º–∞—Ç–æ–∏–¥–Ω—ã–π –∞—Ä—Ç—Ä–∏—Ç":t==="en"?"Rheumatoid Arthritis":"Revmatoid artrit",story_content:t==="ru"?"–¢—Ä–∏ –≥–æ–¥–∞ –Ω–∞–∑–∞–¥ —É –º–µ–Ω—è –Ω–∞—á–∞–ª–∏—Å—å –±–æ–ª–∏ –≤ —Å—É—Å—Ç–∞–≤–∞—Ö. –°–Ω–∞—á–∞–ª–∞ —è –¥—É–º–∞–ª–∞, —á—Ç–æ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —É—Å—Ç–∞–ª–æ—Å—Ç—å, –Ω–æ –±–æ–ª–∏ —É—Å–∏–ª–∏–≤–∞–ª–∏—Å—å. –ü–æ—Å–ª–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ —Ä–µ–≤–º–∞—Ç–æ–ª–æ–≥—É –±—ã–ª –ø–æ—Å—Ç–∞–≤–ª–µ–Ω –¥–∏–∞–≥–Ω–æ–∑ —Ä–µ–≤–º–∞—Ç–æ–∏–¥–Ω—ã–π –∞—Ä—Ç—Ä–∏—Ç. –ë–ª–∞–≥–æ–¥–∞—Ä—è —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–º—É –ª–µ—á–µ–Ω–∏—é –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–µ –≤—Ä–∞—á–µ–π, —Å–µ–π—á–∞—Å —è —á—É–≤—Å—Ç–≤—É—é —Å–µ–±—è –Ω–∞–º–Ω–æ–≥–æ –ª—É—á—à–µ.":t==="en"?"Three years ago, I started experiencing joint pain. At first, I thought it was just fatigue, but the pain got worse. After consulting a rheumatologist, I was diagnosed with rheumatoid arthritis. Thanks to timely treatment and doctor support, I now feel much better.":"Uch yil oldin qo'shmalarda og'riq boshlanganida, dastlab oddiy charchoq deb o'yladim. Ammo og'riqlar kuchayib bordi. Revmatolog shifokorga murojaat qilganimdan so'ng revmatoid artrit tashxisi qo'yildi. O'z vaqtida davolash va shifokorlar yordami tufayli hozir o'zimni ancha yaxshi his qilaman.",treatment_duration:t==="ru"?"18 –º–µ—Å—è—Ü–µ–≤ –ª–µ—á–µ–Ω–∏—è":t==="en"?"18 months of treatment":"18 oylik davolash",outcome:t==="ru"?"–ü–æ–ª–Ω–æ–µ –≤—ã–∑–¥–æ—Ä–æ–≤–ª–µ–Ω–∏–µ, –≤–æ–∑–≤—Ä–∞—Ç –∫ –∞–∫—Ç–∏–≤–Ω–æ–π –∂–∏–∑–Ω–∏":t==="en"?"Complete recovery, return to active life":"To'liq shifo, faol hayotga qaytish",doctor_name:"Dr. Aziza Karimova",content_type:"image",featured_image_url:"https://images.pexels.com/photos/5452201/pexels-photo-5452201.jpeg?auto=compress&cs=tinysrgb&w=800",symptoms:["Qo'shma og'riqlari","Ertalabki qotishlik","Shishish"],treatment_methods:["Dori davolash","Fizioterapiya","Jismoniy mashqlar"],medications:["Metotreksat","Prednizolon","Og'riq qoldiruvchi"],lifestyle_changes:"Sog'lom ovqatlanish, muntazam mashqlar, stress boshqaruvi",rating:5,featured:!0,published:!0,order_index:1,meta_title:"Malika Karimova - Revmatoid artrit shifo tarixi",meta_description:"Revmatoid artritdan shifo topgan bemor tarixi",created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-01T00:00:00Z"},{id:"550e8400-e29b-41d4-a716-446655440002",patient_name:t==="ru"?"–ê–∫–º–∞–ª –†–∞—Ö–∏–º–æ–≤":"Akmal Rahimov",age:52,diagnosis:t==="ru"?"–û—Å—Ç–µ–æ–∞—Ä—Ç—Ä–æ–∑ –∫–æ–ª–µ–Ω–Ω—ã—Ö —Å—É—Å—Ç–∞–≤–æ–≤":t==="en"?"Knee Osteoarthritis":"Tizza qo'shmalari osteoartozi",story_content:t==="ru"?"–†–∞–±–æ—Ç–∞—è —Å—Ç—Ä–æ–∏—Ç–µ–ª–µ–º –±–æ–ª–µ–µ 20 –ª–µ—Ç, —è –Ω–µ –æ–±—Ä–∞—â–∞–ª –≤–Ω–∏–º–∞–Ω–∏—è –Ω–∞ –±–æ–ª–∏ –≤ –∫–æ–ª–µ–Ω—è—Ö. –ö–æ–≥–¥–∞ –±–æ–ª—å —Å—Ç–∞–ª–∞ –Ω–µ–≤—ã–Ω–æ—Å–∏–º–æ–π, –æ–±—Ä–∞—Ç–∏–ª—Å—è –∫ –≤—Ä–∞—á—É. –î–∏–∞–≥–Ω–æ–∑ - –æ—Å—Ç–µ–æ–∞—Ä—Ç—Ä–æ–∑. –ë–ª–∞–≥–æ–¥–∞—Ä—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–º—É –ª–µ—á–µ–Ω–∏—é –∏ —Ñ–∏–∑–∏–æ—Ç–µ—Ä–∞–ø–∏–∏, —Å–º–æ–≥ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ä–∞–±–æ—Ç–µ.":t==="en"?"Working as a builder for over 20 years, I ignored knee pain. When the pain became unbearable, I saw a doctor. Diagnosis - osteoarthritis. Thanks to comprehensive treatment and physiotherapy, I was able to return to work.":"Qurilishchi bo'lib 20 yildan ortiq ishlaganimda tizza og'riqlariga e'tibor bermagan edim. Og'riq chidab bo'lmas darajaga yetganda shifokorga murojaat qildim. Tashxis - osteoartroz. Kompleks davolash va fizioterapiya tufayli ishga qayta qaytishga muvaffaq bo'ldim.",treatment_duration:t==="ru"?"12 –º–µ—Å—è—Ü–µ–≤ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π —Ç–µ—Ä–∞–ø–∏–∏":t==="en"?"12 months of comprehensive therapy":"12 oylik kompleks terapiya",outcome:t==="ru"?"–ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ, –≤–æ–∑–≤—Ä–∞—Ç –∫ —Ä–∞–±–æ—Ç–µ":t==="en"?"Significant improvement, return to work":"Sezilarli yaxshilanish, ishga qaytish",doctor_name:"Dr. Bobur Toshmatov",content_type:"video",youtube_url:"https://www.youtube.com/watch?v=dQw4w9WgXcQ",symptoms:["Tizza og'riqlari","Harakat cheklanganligi","Qotishlik"],treatment_methods:["Fizioterapiya","Injeksiyalar","Jismoniy mashqlar"],medications:["Diklofenak","Gialuronik kislota","Xondroitin"],lifestyle_changes:"Vazn kamaytirish, kam ta'sirli mashqlar, to'g'ri pozitsiya",rating:4,featured:!1,published:!0,order_index:2,meta_title:"Akmal Rahimov - Osteoartroz shifo tarixi",meta_description:"Osteoartroz kasalligidan shifo topgan bemor tarixi",created_at:"2024-01-02T00:00:00Z",updated_at:"2024-01-02T00:00:00Z"},{id:"550e8400-e29b-41d4-a716-446655440003",patient_name:t==="ru"?"–ù–æ–¥–∏—Ä–∞ –ê–±–¥—É–ª–ª–∞–µ–≤–∞":"Nodira Abdullayeva",age:38,diagnosis:t==="ru"?"–§–∏–±—Ä–æ–º–∏–∞ÔøΩÔøΩ–≥–∏—è":t==="en"?"Fibromyalgia":"Fibromyalgiya",story_content:t==="ru"?"–ì–æ–¥–∞–º–∏ —Å—Ç—Ä–∞–¥–∞–ª–∞ –æ—Ç —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∏—Ö –±–æ–ª–µ–π –ø–æ –≤—Å–µ–º—É —Ç–µ–ª—É. –í—Ä–∞—á–∏ –Ω–µ –º–æ–≥–ª–∏ –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ—á–Ω—ã–π –¥–∏–∞–≥–Ω–æ–∑. –ù–∞–∫–æ–Ω–µ—Ü, —Ä–µ–≤–º–∞—Ç–æ–ª–æ–≥ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞–ª —Ñ–∏–±—Ä–æ–º–∏–∞–ª–≥–∏—é. –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ª–µ—á–µ–Ω–∏—è –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ–±—Ä–∞–∑–∞ –∂–∏–∑–Ω–∏ –ø–æ–º–æ–≥–ª–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –∂–∏–∑–Ω–∏.":t==="en"?"For years I suffered from chronic pain throughout my body. Doctors couldn't make an accurate diagnosis. Finally, a rheumatologist diagnosed fibromyalgia. A special treatment program and lifestyle changes helped significantly improve my quality of life.":"Yillar davomida butun vujudimda surunkali og'riqlardan aziyat chekdim. Shifokorlar aniq tashxis qo'ya olmayotgan edi. Nihoyat, revmatolog fibromyalgiya tashxisini qo'ydi. Maxsus davolash dasturi va turmush tarzini o'zgartirish hayot sifatini sezilarli darajada yaxshilashga yordam berdi.",treatment_duration:t==="ru"?"24 –º–µ—Å—è—Ü–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –ª–µ—á–µ–Ω–∏—è":t==="en"?"24 months of comprehensive treatment":"24 oylik kompleks davolash",outcome:t==="ru"?"–ö–æ–Ω—Ç—Ä–æ–ª—å —Å–∏–º–ø—Ç–æ–º–æ–≤, —É–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –∂–∏–∑–Ω–∏":t==="en"?"Symptom control, improved quality of life":"Simptomlarni nazorat qilish, hayot sifatini yaxshilash",doctor_name:"Dr. Nilufar Abdullayeva",content_type:"text",symptoms:["Surunkali og'riq","Charchoq","Uyqu buzilishi"],treatment_methods:["Kognitiv terapiya","Jismoniy mashqlar","Stress boshqaruvi"],medications:["Pregabalin","Amitriptilin","Vitamin D"],lifestyle_changes:"Uyqu rejimi, stress kamaytirish, muntazam mashqlar",rating:4,featured:!1,published:!0,order_index:3,meta_title:"Nodira Abdullayeva - Fibromyalgiya shifo tarixi",meta_description:"Fibromyalgiya kasalligidan shifo topgan bemor tarixi",created_at:"2024-01-03T00:00:00Z",updated_at:"2024-01-03T00:00:00Z"}];export{g as a,b as c,v as d,y as g,k as u};
