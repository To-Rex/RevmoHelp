import{r as i,i as L,h as G,j as e,A as p,f as u,F as o,e as B,L as j,H as E}from"./index-DtX8_sFx.js";import{g as R}from"./adminUsers-CP-dA-7Y.js";import{g as I}from"./patientStories-CvCs9ldW.js";import{g as V}from"./notifications-BHHT7tvd.js";import{C as J}from"./clock-DjrY6wvX.js";import{A as h}from"./arrow-up-right-D-KYUTX0.js";import{E as k}from"./eye-OnB_qZXO.js";import{T as z}from"./trending-up-DxldZ2lZ.js";import{M as K}from"./message-square-Dw2OfevJ.js";import{C as Y}from"./check-circle-Bxw7JPnO.js";import{I as Z}from"./image-BPPfUJcK.js";import{V as O}from"./video-DaUJ8yD-.js";const me=()=>{const[d,_]=i.useState([]),[n,D]=i.useState([]),[S,U]=i.useState([]),[g,T]=i.useState([]),[f,q]=i.useState([]),[P,b]=i.useState(!0),[A,M]=i.useState(new Date);i.useEffect(()=>{N()},[]);const N=async()=>{b(!0);try{const[t,s,c,l,a]=await Promise.all([L("uz",{}),R(),G("uz"),I("uz"),V()]);t.data&&_(t.data),s.data&&D(s.data),c.data&&U(c.data),l.data&&T(l.data),a.data&&q(a.data),M(new Date)}catch(t){console.error("Error loading dashboard data:",t)}finally{b(!1)}},r=(()=>{const t=d.reduce((a,x)=>a+(x.views_count||0),0),s=d.filter(a=>a.published),c=S.filter(a=>a.active&&a.verified);g.filter(a=>a.published);const l=a=>{const x=Math.floor(a*.85);return((a-x)/x*100).toFixed(1)};return{totalUsers:n.length,totalViews:t,totalPosts:s.length,totalDoctors:c.length,userGrowth:l(n.length),viewGrowth:l(t),postGrowth:l(s.length),doctorGrowth:l(c.length)}})(),y=d.sort((t,s)=>new Date(s.created_at).getTime()-new Date(t.created_at).getTime()).slice(0,5).map(t=>({id:t.id,title:t.title,author:t.author?.full_name||"Noma'lum",views:t.views_count||0,status:t.published?"published":"draft",date:new Date(t.created_at).toLocaleDateString("uz-UZ"),type:t.youtube_url?"video":t.featured_image_url?"image":"text"})),v=n.sort((t,s)=>new Date(s.created_at).getTime()-new Date(t.created_at).getTime()).slice(0,5).map(t=>({id:t.id,name:t.user_metadata?.full_name||t.user_metadata?.name||t.email?.split("@")[0]||"User",email:t.email,role:t.user_metadata?.role||"patient",joinDate:new Date(t.created_at).toLocaleDateString("uz-UZ"),avatar:(t.user_metadata?.full_name||t.email?.split("@")[0]||"U").charAt(0).toUpperCase(),provider:t.app_metadata?.provider||"email"})),w=[...d.slice(0,2).map(t=>({id:`post-${t.id}`,user:t.author?.full_name||"Noma'lum muallif",action:t.published?"maqola nashr etdi":"qoralama yaratdi",target:t.title,time:m(t.published_at||t.created_at),color:t.published?"bg-green-500":"bg-yellow-500"})),...n.slice(0,2).map(t=>({id:`user-${t.id}`,user:t.user_metadata?.full_name||t.email?.split("@")[0]||"Foydalanuvchi",action:"ro'yxatdan o'tdi",target:`${t.user_metadata?.role||"patient"} sifatida`,time:m(t.created_at),color:"bg-blue-500"})),...g.slice(0,1).map(t=>({id:`story-${t.id}`,user:"Admin",action:"bemor tarixi qo'shdi",target:t.patient_name,time:m(t.created_at),color:"bg-purple-500"})),...f.slice(0,1).map(t=>({id:`notification-${t.id}`,user:t.creator?.full_name||"System",action:"bildirishnoma yubordi",target:t.title,time:m(t.sent_at),color:"bg-orange-500"}))].sort((t,s)=>new Date(s.time).getTime()-new Date(t.time).getTime()).slice(0,8);function m(t){const s=new Date(t),l=(new Date().getTime()-s.getTime())/(1e3*60*60);return l<1?`${Math.floor(l*60)} daqiqa oldin`:l<24?`${Math.floor(l)} soat oldin`:`${Math.floor(l/24)} kun oldin`}const $=[{name:"Yangi Maqola",icon:o,color:"bg-gradient-to-r from-blue-500 to-cyan-500",href:"/admin/posts/create"},{name:"Foydalanuvchilar",icon:u,color:"bg-gradient-to-r from-emerald-500 to-green-500",href:"/admin/users"},{name:"Analitika",icon:z,color:"bg-gradient-to-r from-violet-500 to-purple-500",href:"/admin/analytics"},{name:"Bildirishnomalar",icon:K,color:"bg-gradient-to-r from-amber-500 to-orange-500",href:"/admin/notifications"}],C=t=>{switch(t){case"video":return O;case"image":return Z;default:return o}},F=t=>{switch(t){case"video":return"text-red-600";case"image":return"text-green-600";default:return"text-blue-600"}},H=t=>t==="google"?e.jsx("div",{className:"w-4 h-4 bg-white rounded-full flex items-center justify-center shadow-sm",children:e.jsxs("svg",{className:"w-3 h-3",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}):"ðŸ“§";return P?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"theme-text-muted",children:"Dashboard yuklanmoqda..."})]})}):e.jsxs("div",{className:"space-y-4 lg:space-y-6 xl:space-y-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-2 lg:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl lg:text-2xl font-bold theme-text",children:"Dashboard"}),e.jsx("p",{className:"theme-text-secondary mt-1 text-sm lg:text-base",children:"Platformangiz holatini kuzatib boring"})]}),e.jsxs("div",{className:"flex items-center space-x-3 lg:space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-xs lg:text-sm theme-text-muted",children:[e.jsx(J,{size:16}),e.jsxs("span",{children:["Oxirgi yangilanish: ",A.toLocaleTimeString("uz-UZ")]})]}),e.jsxs("button",{onClick:N,className:"flex items-center space-x-2 theme-accent-bg text-white px-3 lg:px-4 py-2 lg:py-2.5 rounded-lg hover:bg-blue-700 transition-colors duration-200 text-sm",children:[e.jsx(p,{size:16}),e.jsx("span",{children:"Yangilash"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6",children:[e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border p-4 lg:p-6 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 lg:p-3 rounded-xl bg-primary-100 dark:bg-primary-900/20",children:e.jsx(u,{size:20,className:"lg:size-22 text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(h,{size:14,className:"text-secondary-500"}),e.jsxs("span",{className:"text-xs lg:text-sm font-medium text-secondary-600 dark:text-secondary-400",children:["+",r.userGrowth,"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl lg:text-2xl font-bold theme-text mb-1",children:r.totalUsers.toLocaleString()}),e.jsx("p",{className:"text-xs lg:text-sm theme-text-secondary",children:"Jami Foydalanuvchilar"})]})]}),e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border p-4 lg:p-6 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 lg:p-3 rounded-xl bg-primary-100 dark:bg-primary-900/20",children:e.jsx(o,{size:20,className:"lg:size-22 text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(h,{size:14,className:"text-secondary-500"}),e.jsxs("span",{className:"text-xs lg:text-sm font-medium text-secondary-600 dark:text-secondary-400",children:["+",r.postGrowth,"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl lg:text-2xl font-bold theme-text mb-1",children:r.totalPosts}),e.jsx("p",{className:"text-xs lg:text-sm theme-text-secondary",children:"Nashr Etilgan Maqolalar"})]})]}),e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border p-4 lg:p-6 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 lg:p-3 rounded-xl bg-primary-100 dark:bg-primary-900/20",children:e.jsx(k,{size:20,className:"lg:size-22 text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(h,{size:14,className:"text-secondary-500"}),e.jsxs("span",{className:"text-xs lg:text-sm font-medium text-secondary-600 dark:text-secondary-400",children:["+",r.viewGrowth,"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl lg:text-2xl font-bold theme-text mb-1",children:r.totalViews.toLocaleString()}),e.jsx("p",{className:"text-xs lg:text-sm theme-text-secondary",children:"Jami Ko'rishlar"})]})]}),e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border p-4 lg:p-6 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 lg:p-3 rounded-xl bg-primary-100 dark:bg-primary-900/20",children:e.jsx(B,{size:20,className:"lg:size-22 text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(h,{size:14,className:"text-secondary-500"}),e.jsxs("span",{className:"text-xs lg:text-sm font-medium text-secondary-600 dark:text-secondary-400",children:["+",r.doctorGrowth,"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl lg:text-2xl font-bold theme-text mb-1",children:r.totalDoctors}),e.jsx("p",{className:"text-xs lg:text-sm theme-text-secondary",children:"Faol Shifokorlar"})]})]})]}),e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border p-4 lg:p-6",children:[e.jsx("h2",{className:"text-lg lg:text-xl font-bold theme-text mb-4 lg:mb-6",children:"Tezkor Amallar"}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 lg:gap-4",children:$.map(t=>{const s=t.icon;return e.jsxs(j,{to:t.href,className:`${t.color} text-white p-4 lg:p-5 rounded-xl hover:opacity-90 transition-all duration-200 transform hover:scale-105 block`,children:[e.jsx(s,{size:20,className:"lg:size-22 mb-2 lg:mb-3 mx-auto"}),e.jsx("div",{className:"text-xs lg:text-sm font-medium text-center",children:t.name})]},t.name)})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-6",children:[e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border",children:[e.jsx("div",{className:"p-4 lg:p-6 theme-border border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg lg:text-xl font-bold theme-text",children:"So'nggi Maqolalar"}),e.jsx(j,{to:"/admin/posts",className:"text-xs lg:text-sm theme-accent hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:"Barchasini ko'rish"})]})}),e.jsx("div",{className:"p-4 lg:p-6",children:e.jsx("div",{className:"space-y-4",children:y.length>0?y.map(t=>{const s=C(t.type);return e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between p-4 theme-bg-tertiary rounded-xl transition-all duration-200 space-y-2 lg:space-y-0",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(s,{size:16,className:`${F(t.type)}`}),e.jsx("p",{className:"text-sm font-semibold theme-text line-clamp-2 lg:truncate",children:t.title})]}),e.jsxs("p",{className:"text-sm theme-text-muted mb-2",children:[t.author," tomonidan"]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs theme-text-muted",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(k,{size:12}),e.jsxs("span",{children:[t.views.toLocaleString()," ko'rishlar"]})]}),e.jsx("span",{children:t.date})]})]}),e.jsx("div",{className:"lg:ml-4 flex-shrink-0",children:e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${t.status==="published"?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200"}`,children:t.status==="published"?"Nashr etilgan":"Qoralama"})})]},t.id)}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(o,{size:32,className:"theme-text-muted mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"theme-text-secondary text-sm",children:"Hozircha maqolalar yo'q"})]})})})]}),e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border",children:[e.jsx("div",{className:"p-4 lg:p-6 theme-border border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg lg:text-xl font-bold theme-text",children:"So'nggi Foydalanuvchilar"}),e.jsx(j,{to:"/admin/users",className:"text-xs lg:text-sm theme-accent hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:"Barchasini ko'rish"})]})}),e.jsx("div",{className:"p-4 lg:p-6",children:e.jsx("div",{className:"space-y-4",children:v.length>0?v.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-4 theme-bg-tertiary rounded-xl transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 lg:w-10 lg:h-10 bg-primary-100 dark:bg-primary-900/50 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-sm font-semibold theme-accent",children:t.avatar})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"text-sm font-semibold theme-text truncate",children:t.name}),H(t.provider)]}),e.jsx("p",{className:"text-xs theme-text-muted truncate",children:t.email})]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full capitalize ${t.role==="doctor"?"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200":t.role==="admin"?"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"}`,children:t.role}),e.jsx("div",{className:"text-xs theme-text-muted mt-1 hidden lg:block",children:t.joinDate})]})]},t.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(u,{size:32,className:"theme-text-muted mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"theme-text-secondary text-sm",children:"Hozircha foydalanuvchilar yo'q"})]})})})]})]}),e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border",children:[e.jsx("div",{className:"p-4 lg:p-6 theme-border border-b",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{size:18,className:"lg:size-20 theme-accent"}),e.jsx("h2",{className:"text-lg lg:text-xl font-bold theme-text",children:"So'nggi Faollik"})]})}),e.jsx("div",{className:"p-4 lg:p-6",children:e.jsx("div",{className:"space-y-4",children:w.length>0?w.map(t=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`w-2 h-2 ${t.color} rounded-full mt-2 flex-shrink-0`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm theme-text",children:[e.jsx("span",{className:"font-semibold",children:t.user})," ",t.action,t.target&&e.jsxs("span",{className:"font-medium",children:[' "',t.target,'"']})]}),e.jsx("p",{className:"text-xs theme-text-muted",children:t.time})]})]},t.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(p,{size:32,className:"theme-text-muted mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"theme-text-secondary text-sm",children:"Hozircha faollik yo'q"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 lg:gap-6",children:[e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border p-4 lg:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-base lg:text-lg font-semibold theme-text",children:"Tizim Holati"}),e.jsx(Y,{size:18,className:"text-secondary-500"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:"Server"}),e.jsx("span",{className:"text-sm font-medium text-secondary-600 dark:text-secondary-400",children:"Onlayn"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:"Ma'lumotlar bazasi"}),e.jsx("span",{className:"text-sm font-medium text-secondary-600 dark:text-secondary-400",children:"Ulangan"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:"Xotira"}),e.jsx("span",{className:"text-sm font-medium text-secondary-600 dark:text-secondary-400",children:"78% ishlatilgan"})]})]})]}),e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border p-4 lg:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-base lg:text-lg font-semibold theme-text",children:"Samaradorlik"}),e.jsx(z,{size:18,className:"text-primary-500"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:"Javob vaqti"}),e.jsx("span",{className:"text-sm font-medium theme-text",children:"245ms"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:"Uptime"}),e.jsx("span",{className:"text-sm font-medium theme-text",children:"99.9%"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:"Yuklanish"}),e.jsx("span",{className:"text-sm font-medium theme-text",children:"Past"})]})]})]}),e.jsxs("div",{className:"theme-bg rounded-2xl theme-border border p-4 lg:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-base lg:text-lg font-semibold theme-text",children:"Kontent"}),e.jsx(E,{size:18,className:"text-secondary-500"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:"Bemor tarixi"}),e.jsx("span",{className:"text-sm font-medium theme-text",children:g.filter(t=>t.published).length})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:"Kategoriyalar"}),e.jsx("span",{className:"text-sm font-medium theme-text",children:"6"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm theme-text-secondary",children:"Bildirishnomalar"}),e.jsx("span",{className:"text-sm font-medium theme-text",children:f.filter(t=>t.active).length})]})]})]})]})]})};export{me as default};
